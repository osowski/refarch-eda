(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{rIQ7:function(e,a,t){"use strict";t.r(a),t.d(a,"_frontmatter",(function(){return i})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("zLVn"),r=(t("q1tI"),t("7ljp")),c=t("013z"),i=(t("qKvR"),{}),o=function(e){return function(a){return console.warn("Component '"+e+"' was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",a)}},l=o("AnchorLinks"),b=o("AnchorLink"),p=o("InlineNotification"),m={_frontmatter:i},d=c.a;function h(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(r.b)(d,Object(n.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("p",null,"This documentation aims to be a introductory hands-on lab on the IBM Event Streams Schema Registry installed throught the IBM Cloud Pak for Integration on an Openshift cluster."),Object(r.b)("h2",null,"Index"),Object(r.b)(l,{mdxType:"AnchorLinks"},Object(r.b)(b,{mdxType:"AnchorLink"},"Requirements"),Object(r.b)(b,{mdxType:"AnchorLink"},"IBM Cloud Shell"),Object(r.b)(b,{mdxType:"AnchorLink"},"Schema Registry"),Object(r.b)(b,{mdxType:"AnchorLink"},"Schemas"),Object(r.b)(b,{mdxType:"AnchorLink"},"IBM Event Streams Credentials"),Object(r.b)(b,{mdxType:"AnchorLink"},"Python Application"),Object(r.b)(b,{mdxType:"AnchorLink"},"Python Avro Producer"),Object(r.b)(b,{mdxType:"AnchorLink"},"Python Avro Consumer"),Object(r.b)(b,{mdxType:"AnchorLink"},"Schemas and Messages"),Object(r.b)(b,{mdxType:"AnchorLink"},"Data Evolution"),Object(r.b)(b,{mdxType:"AnchorLink"},"Security")),Object(r.b)("h2",null,"Requirements"),Object(r.b)("p",null,"This lab requires the following components to work against:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"An IBM Event Streams instance installed through the IBM CloudPak for Integration."),Object(r.b)("li",{parentName:"ol"},"An IBM Cloud Shell - ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.ibm.com/cloud/cloud-shell"}),"https://www.ibm.com/cloud/cloud-shell"))),Object(r.b)("h2",null,"IBM Cloud Shell"),Object(r.b)("p",null,"Here we are going to set up our IBM Cloud Shell with all the tools required to carry out this lab."),Object(r.b)("p",null,"Start your IBM Cloud Shell by pointing your browser to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://cloud.ibm.com/shell"}),"https://cloud.ibm.com/shell")),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"68.75%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACAklEQVQ4y52SS28SYRSG56dwCbeZ4X4ZaAt1wXAJ/AIECgKWxEUNl0UJKAsjsXHrpYmaWOhCbn+DsOA3uHEjbcQUFwZrXjkfKRdrjDLJk/fMOd958+Wd4cafPmI8nWA2+4mr6TfMflyDnu+za3y+mODyyxUu5pCOL78y3WAynbN65zrtD+j1emidn+PFy1d4fXqKN2/fodlq4f1ZE2fN1gbdbhf9fp/tEJ1Oh/WIdrsN7m7yHnL5B8hms4jH40gmk4xEInGLXC435z4OD/PIZDJIpVLLnYODRc09evIcx48beNpo4OTkGer1OqrVKmq1GtMVNVQqFZRKJZTLZRSLRRQKBRwdPWRK0Izz7u1gd8cDl8sFs9kMQRCg1Wqh1+thMplgMBig0+kYNNNoNFAoFFAqlQyVSrWsqc8FQ0HIsgw5ICMQCCwJhUIIh8MbvUgkgmAwyGbRaJTVfr+fzcjDaDSC29v1wumQ4JYWt5QkCR6PB263m9WEw+GA0+lkUL0+s9lsS/V6veB8sgv7AQk+v4T9Oz522G63s0U6aLVaIYriBnST9XeKSq1WI5/PgxNNPESTAYJICCyzGyhHUp7n/wqZUobpdBoczwtYwbPgt4F26SNyiwZ/a/ivJr/3uP8x+JMZ6XpMWxve7FF+FotlydaGZEQ/dSwWw2g0wmAwwHA4xC+IBx9VlHt57AAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"shell",title:"shell",src:"/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/3cbba/shell-v10.png",srcSet:["/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/7fc1e/shell-v10.png 288w","/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/a5df1/shell-v10.png 576w","/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/3cbba/shell-v10.png 1152w","/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/0b124/shell-v10.png 1728w","/refarch-eda/static/8b4cc3d6ec3d2ea71da45dc510804a45/e957c/shell-v10.png 1920w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("h4",null,"IBM Cloud Pak CLI"),Object(r.b)("p",null,"Cloudctl is a command line tool to manage Container Application Software for Enterprises (CASEs). This CLI will allow us to manage Cloud Pak related components as well as software, like IBM Event Streams, installed through any IBM Cloud Pak."),Object(r.b)("p",null,"In order to install it, execute the following commands in your IBM Cloud Shell:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Download the IBM Cloud Pak CLI - ",Object(r.b)("inlineCode",{parentName:"li"},"curl -L https://github.com/IBM/cloud-pak-cli/releases/latest/download/cloudctl-linux-amd64.tar.gz -o cloudctl-linux-amd64.tar.gz")),Object(r.b)("li",{parentName:"ol"},"Untar it - ",Object(r.b)("inlineCode",{parentName:"li"},"tar -xvf cloudctl-linux-amd64.tar.gz")),Object(r.b)("li",{parentName:"ol"},"Rename it for ease of use - ",Object(r.b)("inlineCode",{parentName:"li"},"mv cloudctl-linux-amd64 cloudctl")),Object(r.b)("li",{parentName:"ol"},"Include it to the PATH environment variable - ",Object(r.b)("inlineCode",{parentName:"li"},"export PATH=$PATH:$PWD")),Object(r.b)("li",{parentName:"ol"},"Make sure your IBM Cloud Pak CLI is in the path- ",Object(r.b)("inlineCode",{parentName:"li"},"which cloudctl")),Object(r.b)("li",{parentName:"ol"},"Make sure your IBM Cloud Pak CLI works - ",Object(r.b)("inlineCode",{parentName:"li"},"cloudctl help"))),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"95.4861111111111%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACfElEQVQ4y3WUyU4bYRCE52EQO3jBnvGGxx578I6DhJIoQkqUC0eeBhEUsVjCVi55xoq/dtoZLOfQ+vfq6q6aCaKopqTdVa1aUz6XV6FQULFYtCgUirZmZF1d3mk0GqrX68t5VWdnZxalUknlctnuBj8Wr/r5a6bF71fNF3O9vRFvFvP5XIvFYr0mXl5eNJvN9PT0pMfHRz08POj5+dnG+/t7BaWwqLAaqlKL1Gw2ValUVKutmDAnMwET9mGxt7eng4ODd7G/v6/d3V0Fw+FAadpVr9fT+fm58vm8ut2ugfT7fYuLiwsD94QAHB8f6+jo6F2wF0y/VzX5Furya12tJFbcjNXpdNRutxXHsQFw0VnBZDPYPzw8NNBg9Lmh6U2s0aemBsO+ptOpRqORgbZaLSudUmHP3EUhSMgZotAKQIPLL219uOlo/LGltJcuL7WMVS6Xe6e4K7pSvbDeY356erpuQUCZlaUo5bCkqBJZNvrIZR7RS/bcGj76uTNbl5y0E/NUFEbGLIpWI3uMrrQDcM765ORkuyj0yfvA5TAMDYygT+yTncvOZFsAiHABjfUysEeSJJbAmQGMEMxdTQfIBmrf3d0pcLXw2NXVlYbDofmQNUqTwFryt1QXApAsMOz4kgIeYglYjcdjAwCQJHiROW1wQejdNlPD8Pb29h8gTPEgALBAaUok86aJN8OZ7uzsrABhR1mTycRKTtPU2FEypXqZ7sWsN521Cxd4f3jA6HZhdHGyD7dFtp9mG34MMKN07w/ud1/6v4+SeZhVe1N1s8319bUFtgGAz45D/jQkGwwGNndvAr5pnTVDyoIlPWHDy0BV34M1jP9XZnb+B8y2gk1TLpdZAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"shell2",title:"shell2",src:"/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/3cbba/shell2-v10.png",srcSet:["/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/7fc1e/shell2-v10.png 288w","/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/a5df1/shell2-v10.png 576w","/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/3cbba/shell2-v10.png 1152w","/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/0b124/shell2-v10.png 1728w","/refarch-eda/static/60e97a38100e48a5ef64dbf40f475c8a/e957c/shell2-v10.png 1920w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("h4",null,"Event Streams plugin for IBM Cloud Pak CLI"),Object(r.b)("p",null,"This plugin will allow us to manage IBM Event Streams."),Object(r.b)("p",null,"In order to install it, execute the following commands in your IBM Cloud Shell:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Download the Event Streams plugin for IBM Cloud Pak CLI - ",Object(r.b)("inlineCode",{parentName:"li"},"curl -L http://ibm.biz/es-cli-linux -o es-plugin")),Object(r.b)("li",{parentName:"ol"},"Install it - ",Object(r.b)("inlineCode",{parentName:"li"},"cloudctl plugin install es-plugin")),Object(r.b)("li",{parentName:"ol"},"Make sure it works - ",Object(r.b)("inlineCode",{parentName:"li"},"cloudctl es help"))),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"37.84722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPklEQVQoz5WS3W6CQBCFeRKMAa2KgPwpQlJDjQQoEqomfQ+NEW/QplC9aJ/5lJ2KadPUpBdfzmZ29uzMznKr1TPixxhhECAMwx9EUYSwIrrAYkmSYLlcVqyQpiniOMZ8PidYDvfy/obTxxmv5QlFWaIoCpQXzfMcx+MRh8OB1rXu93vsdjtst1us12tsNhsiyzJwowcZhmdAdzTohgpN06AoCjqdDkRRJG2322i1Wt/0rlIBzWYDjcYXPM9TPhc8jTG+1+A6NhxnDMMwIcvyv+n3+9B1HdxwNISiKhXqdYOpJEno9XoEW/9Fvd/tdjEYDMCZpkVtmqZBN9g2q9SBZVlQq0tY+7dMfxlOp1MKCIJAZmxqvu/TRCeTCb1hfehWxVdD9g1msxlV5bouFosFmbI4M/U8jzpgB261Xht+AlkeEbh4JRS1AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"shell3",title:"shell3",src:"/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/3cbba/shell3-v10.png",srcSet:["/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/7fc1e/shell3-v10.png 288w","/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/a5df1/shell3-v10.png 576w","/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/3cbba/shell3-v10.png 1152w","/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/0b124/shell3-v10.png 1728w","/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/4ea69/shell3-v10.png 2304w","/refarch-eda/static/8f4b12c8a2eaff22d44dd16cbb159ea3/94175/shell3-v10.png 2360w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("h4",null,"Git"),Object(r.b)("p",null,"IBM Cloud Shell comes with Git already installed out of the box."),Object(r.b)("h4",null,"Vi"),Object(r.b)("p",null,"IBM Cloud Shell comes with Vi already installed out of the box."),Object(r.b)("h4",null,"Python 3"),Object(r.b)("p",null,"IBM Cloud Shell comes with Python 3 already installed out of the box. However, we need to install the following modules that will be used later on in this tutorial when we run a Python application to work with Avro, Schemas and messages. These modules are ",Object(r.b)("inlineCode",{parentName:"p"},"confluent_kafka")," and ",Object(r.b)("inlineCode",{parentName:"p"},"avro-python3")),Object(r.b)("p",null,"In order to install these modules, execute the following command in your IBM Cloud Shell:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Install the modules - ",Object(r.b)("inlineCode",{parentName:"li"},"python3 -mpip install avro-python3 confluent_kafka"))),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"35.76388888888889%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABT0lEQVQoz3WQyW7CQBBE/TdsBxAGG7zHY8uOiUBC5EJA4sIpiHwJYhNEuUQIbIzykxW6yWQ55PA0bc+oqroUo20jDCLYlgNVVdFoNP6gqj+zZVnwPA/uFdt2oOs6Wq0W2u02Q2+U1+yAt/yA9OMdp/SE8/nMpGnKXC4XZFmGPM9xPB6x2+2w3++x2WywXC6xWCywXq+xWq2w3W6hBJGAJ1zG931oms7OhmGwe7PZ/Ep6S18ul1EoFFAsFlEqlRiaJYrwBWbPM8znL1fmmE6nmEwmEEKwAa1Zr9dRrVZRq9VYUIr9FqLvSqUCJQxDDJ+GGDwO0O/3MRqNMB6P0e12Eccxd0YpKS0ll70RpmmyIZ30hgWT+w7u44TpJAl6vR6iKOKErnurwXGc7+KpCjlLQfpHG1B6JXywIDom7mIDQSD4UtM0dpRpqD+56n/IlT8B8bMCI00uH84AAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"shell4",title:"shell4",src:"/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/3cbba/shell4-v10.png",srcSet:["/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/7fc1e/shell4-v10.png 288w","/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/a5df1/shell4-v10.png 576w","/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/3cbba/shell4-v10.png 1152w","/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/0b124/shell4-v10.png 1728w","/refarch-eda/static/a63684e3f3908025e797711c4c4396d7/e957c/shell4-v10.png 1920w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Congrats!")," you have now your IBM Cloud Shell ready to start working."),Object(r.b)("h2",null,"Schema Registry"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"800px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"56.25%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAxOAAAMTgF/d4wjAAABqUlEQVQoz6WRX2/TMBTF8/2/AIwnYBpCCCEeqmljLXvoQNlWMVZIpUI1RrqFJDRxHNvxv+sb7IZpwCtHfrCv/Dv3XDtSFn+2tqS24gAOtcEfuWiZ9QfdWcWNEkZ2kK5lXiglrS+iw77vLWCUEfvqvHnxvj6cs7pSrDXf11hV4ABlbbrGBBcNm7qvCfo9GG9q+q2irIHXs/r5ND1KGOPWl4Tsrgtyla5PZxdpmm2bQH8nb3oPC+2+ZnRx3S5TBS6UtAEm7TSOX45Gy9UqwDbAiL2PC4DKJx9gB9CQupNGKz34hdERy82mJsT3xNA5uBrAs2/q7WU5vihOr5Q0GPkqF5bQ4UKwB+c8fXB8vLO7O18sQhZrB3h/zvempV+jj0zoLUwoZLkVnfs9Fjq/qrK6XWdtQ4OhC7H9Gy9zfb4S8Re+uNXabmEf0/v4O1y6wzmZJHz8ie/PmvFndvChnSTiKBE3tTUaGUNjHW2Fg5AlGpp1CqSyG6ofjIvHJ3Qvbh9N8odvsqcn5FnMnrxrkxvJmM0LR5lpqP8Xfg//KR/P4d0Efx//UdT/h34B5ttvMT+t4qsAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"diagram",title:"diagram",src:"/refarch-eda/static/70d666355fd2041ad3560536b71be85b/acfc1/schema-registry.png",srcSet:["/refarch-eda/static/70d666355fd2041ad3560536b71be85b/7fc1e/schema-registry.png 288w","/refarch-eda/static/70d666355fd2041ad3560536b71be85b/a5df1/schema-registry.png 576w","/refarch-eda/static/70d666355fd2041ad3560536b71be85b/acfc1/schema-registry.png 800w"],sizes:"(max-width: 800px) 100vw, 800px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("p",null,"One of the most common technologies used in the industry these days to define, serialize and deserialize messages flowing through your Kafka topics is Apache Avro (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://avro.apache.org/docs/current/"}),"https://avro.apache.org/docs/current/"),"). To learn more about Apache Avro, how to define Apache Avro data schemas and more, we strongly recommend to read through our documentation on Avro and data schemas ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"../../avro-schemas/"}),"here")),Object(r.b)("p",null,"IBM Event Streams development team has developed a Schema Registry to work along your Kafka cluster to provide a place to store descriptions of the message formats used by your producers and consumers. The benefit of storing these descriptions is that you are able to validate that your producing and consuming applications will correctly inter-operate. The Schema Registry will also provide the ability for schemas to evolve in time."),Object(r.b)("h3",null,"Accessing the Schema Registry"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"To access the schema registry, we first need to log into IBM Event Streams."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Point your browser to your IBM Event Streams instace’s user interface url and introduce your credentials"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"71.875%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6klEQVQ4y41T226bUBDk9/pn/aK8NMpDVLV9aBUnjaW0rupLDMZgOJwbF3OZ7h4C2I0b9UijRdg7O2d28ILtEqnMkEYxtFQQmcRqs8Xv1TOW6y1WhPVzAH8XIQhj+MGeaoQoTrGPkxER1yiBV5QVcmthsgyKkAoB4ZD1ld5lUsIYi7puUDcNGgKfrutwfjp4WitoraGNoaa30bZ/E2AkHuCNDUz6BgbCuq6R5zkyUp4kCSSpPyV2hGMTIbd97QeYM0JuKMvSkQ1gQkuWDTZ4SinnjzV94z7RkMpAKSZVNGAiZctYHXvbtq0jYbDqwU+PvYvjCGEssQk1Fn6Bpx8/kaYJhLRY+gKZSJ1abqqqyg3jymoZRVFMCkva8uzuG26/PCBMK1RW4Pr6AzbrFaQ54ubTHI/fH8D/a0hVfaRUaEE3UlCkuiyLc0KenIkE88UO28g4lTe3n3FPQzJ9xNf5DuHOh7E5KWxhyw7L/RGCfmuao7sugy048VDTNAutJH4FBRbLAPezO9i8oAz2C+EKtPj4BLx7D1zN+s2+8ExbnqLR57HMaSlS4HA40LWMe89D+Sasgr2vm+4lk91ZBp3CIYfcMESIK0dheJ5y2I5fRK/odci9SwE+fb5E2CvCSHpK7On/+EIuEf7r/AGteTXJMKSawgAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"login",title:"login",src:"/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/3cbba/login-v10.png",srcSet:["/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/7fc1e/login-v10.png 288w","/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/a5df1/login-v10.png 576w","/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/3cbba/login-v10.png 1152w","/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/0b124/login-v10.png 1728w","/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/4ea69/login-v10.png 2304w","/refarch-eda/static/ab3277aeb6c5619486e307f5646bb05e/32a2f/login-v10.png 2456w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Once you are logged into your IBM Event Streams instance, you simply need to click on the Schema Registry button on the main left hand vertical menu bar:"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.23611111111111%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7UlEQVQoz62Py2rDMBBF9X3N7ygysQt5LgP5jizzQ/Wi+BFbfkiynbibW4+CgtxFIRDBYUZ3NDNX7GOxwP5wAOccQRAgDMOXiaIQn9Ejsu1mDTrj+IN3HHYUfJp2h9Ia2kMphbZtZ5qDdKobo9G0CqeLxu6scZUKbL9a4T65y7IMeZ5DSomqqlAUhdUoJ80nTVNbp7yciL8lvia0NmBcCGuVNtIjt92P5MoY86Trutn9NhiMt97qTCyXdmDTNIjjGGVZWqfkIkkSC2l1XVu3FP9CvW44E55D52QYhhl9/9j+H875cyB9zS++iuv7BaI4Pn8RCJCWAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"4",title:"4",src:"/refarch-eda/static/1746f732222403ca171a74ca96e304d3/3cbba/4-v10.png",srcSet:["/refarch-eda/static/1746f732222403ca171a74ca96e304d3/7fc1e/4-v10.png 288w","/refarch-eda/static/1746f732222403ca171a74ca96e304d3/a5df1/4-v10.png 576w","/refarch-eda/static/1746f732222403ca171a74ca96e304d3/3cbba/4-v10.png 1152w","/refarch-eda/static/1746f732222403ca171a74ca96e304d3/0b124/4-v10.png 1728w","/refarch-eda/static/1746f732222403ca171a74ca96e304d3/4ea69/4-v10.png 2304w","/refarch-eda/static/1746f732222403ca171a74ca96e304d3/7e322/4-v10.png 3076w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"We can also interact with the Schema Registry through the IBM Event Streams CLI. In order to do so, we first need to log in with the IBM Cloud Pak CLI:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Log into your cluster with the IBM CloudPak CLI"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Make sure to use the appropriate credentials and select the namespace where your IBM Event Streams instance is installed")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'cloudctl login -a https://cp-console.apps.eda-solutions.gse-ocp.net --skip-ssl-validation\n\nUsername> admin\n\nPassword> \nAuthenticating...\nOK\n\nTargeted account mycluster Account\n\nEnter a namespace > integration\nTargeted namespace integration\n\nConfiguring kubectl ...\nProperty "clusters.mycluster" unset.\nProperty "users.mycluster-user" unset.\nProperty "contexts.mycluster-context" unset.\nCluster "mycluster" set.\nUser "mycluster-user" set.\nContext "mycluster-context" created.\nSwitched to context "mycluster-context".\nOK\n\nConfiguring helm: /Users/user/.helm\nOK\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Initialize the Event Streams CLI plugin"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es init    \n                                              \nIBM Cloud Platform Common Services endpoint:   https://cp-console.apps.eda-solutions.gse-ocp.net   \nNamespace:                                     integration   \nName:                                          es-1   \nIBM Cloud Pak for Integration UI address:      No instance of Cloud Pak for Integration has been found. Please check that you have access to it.   \nEvent Streams API endpoint:                    https://es-1-ibm-es-admapi-external-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams API status:                      OK   \nEvent Streams UI address:                      https://es-1-ibm-es-ui-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams Schema Registry endpoint:        https://es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams bootstrap address:               es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443   \nOK\n")),Object(r.b)("p",{parentName:"li"},"(","*",")The above information will later be used in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#ibm-event-streams-credentials"}),"IBM Event Streams Credentials")," section as these are neeeded by the Python application we will work with.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Make sure you can access the IBM Event Streams Schema Registry:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schemas\n\nNo schemas were found.\nOK\n")))),Object(r.b)("h2",null,"Schemas"),Object(r.b)("p",null,"In this section we will finally get our hands dirty with the IBM Event Steams Schema Registry capability by working with Apache Avro schemas and the Schema Registry."),Object(r.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(r.b)("p",null,"We recommend to complete most of the UI steps from your ",Object(r.b)("strong",{parentName:"p"},"local workstation")," since these will require you to upload the files your create/modify to IBM Event Streams and that requires having your files available locally on your workstation rather than on the IBM Cloud Shell")),Object(r.b)("h3",null,"Create a schema"),Object(r.b)("p",null,"Let’s see how can we create a schema to start playing with."),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"The IBM EVent Streams user interface allow us to create schemas only from ",Object(r.b)("em",{parentName:"p"},"json")," or Avro schema ",Object(r.b)("em",{parentName:"p"},"avsc")," files."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Create an Avro schema file ",Object(r.b)("strong",{parentName:"p"},"avsc")," with your schema:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Change USER1")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'echo \'{              \n"type":"record",\n"name":"demoSchema_UI_USER1",\n"namespace": "schemas.demo.ui",\n"fields":[\n    {"name": "eventKey","type":"string"},\n    {"name": "message","type":"string"}]\n}\' > demoshema-ui.avsc\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"On the IBM Event Streams Schema Registry User Interface, Click on ",Object(r.b)("em",{parentName:"p"},"Add schema")," button on the top right corner.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Upload definition")," button on the left hand side and select the ",Object(r.b)("inlineCode",{parentName:"p"},"demoschema-ui.avsc")," file we just created.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You should now see you Avro schema loaded in the UI with two tabs, definition and preview to make sure your schema looks as desired:"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.583333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABT0lEQVQoz5WQ3UsCQRTF90/2C0JJLPo/Qgh8L3wpVAx7kAgi6MHAByMhw/2amV13tdVfM7MqCkE0cLj3nnvvmTPjVGt1Tqp1CoUC5XKZUqlEsVi0eaVS+RONxhnnjRoX9RKn1QpOkq4I5QKpYv57Nhu4791x3R9zNYTnd3AC9xN/Nka4U3zfp91u02w2mUwmJEmClBIhhEUYhhomDzUv8PyAXueWm94rrUHK40jg9F8EjZbPZUcQ6IWHwYBut8t8PidNU4IgwPM8KxZFEUophFQEQhHrOltrm+slZJJVqnBGHwvaT0uGbys9nC9kWUYcxzY3ggbGqamjrWAoIn2BsryUhov0t0U4y0TBt2S9UnbBPHu/rB1Yh65n60MYMWMgj/msgWNIuVU3jek0/0s7oDnXd5m5X9qBsPWxaHSUW8EduYuH7ixnnqWOuX3vF+4HCThBpyqstDAAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"5",title:"5",src:"/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/3cbba/5-v10.png",srcSet:["/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/7fc1e/5-v10.png 288w","/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/a5df1/5-v10.png 576w","/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/3cbba/5-v10.png 1152w","/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/0b124/5-v10.png 1728w","/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/4ea69/5-v10.png 2304w","/refarch-eda/static/4dab3b5998918ccd7eda9b58f6d0f6c7/e5652/5-v10.png 2866w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Add schema")," button at the top right corner and you should now see that schema listed among your other schemas."))),Object(r.b)("h4",null,"CLI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Create another Avro schema ",Object(r.b)("strong",{parentName:"p"},"avsc")," file with a different schema:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Change USER1")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'echo \'{              \n"type":"record",\n"name":"demoSchema_CLI_USER1",\n"namespace": "schemas.demo.cli",\n"fields":[\n    {"name": "eventKey","type":"string"},\n    {"name": "message","type":"string"}]\n}\' > demoshema-cli.avsc\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Create a schema by executing the following command:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-cli.avsc \n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema           State    Updated                         Comment   \n1.0.0     1            demoSchema_CLI_USER1   active   Thu, 25 Jun 2020 11:30:42 UTC      \n\nAdded version 1.0.0 of schema demoSchema_CLI_USER1 to the registry.\nOK\n")))),Object(r.b)("h3",null,"List schemas"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"In order to list the schemas in the UI you just simply need to open up the Schema Registry User Interface and schemas will get listed in there automatically. You also have a search tool bar at the top. You can also see more details about your schema by clicking the drop down arrow on its left:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"64.58333333333334%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOElEQVQ4y6VSSU7EMBDM8/IXblkgaMQQvsFTuPEBDpw4IiXKSqLE2Z2lSBsczYSAosFSqe2yu9yutqKqKmzbhqZpMAwDlmVdhJvvqNwfj6DRdR2GYcB/h3K4exCToihQVZWIW2CMIcsyESWXZQxtnePpheHqkeH5lUGxbg9omgaO4yAMQ6RpKhLXIN73/WWd57lYx3EEP8rx9p4h/JgFr01TVChvb9sWfd/vBuc9xqEHJj7n1lAMwxTeUYVRFAnhv569zX+BLFOoszQ8z0OSJCjL8lfBNU7P0vxMkDyiCuq6FqDNdVxzUoQieUrcIkgE3US+jOP4A2QL4ZTjnC/naY+auwgGQSCeTFXKW2VVe7A82Zy7PE0TXNedv0C8278tP888lB2WRlPcC/kDhKCu60JQEpeARGX+J3Y0vKU1YgyiAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"6",title:"6",src:"/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/3cbba/6-v10.png",srcSet:["/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/7fc1e/6-v10.png 288w","/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/a5df1/6-v10.png 576w","/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/3cbba/6-v10.png 1152w","/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/0b124/6-v10.png 1728w","/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/4ea69/6-v10.png 2304w","/refarch-eda/static/69a457957d9ab49bff269226e3c8a246/497fa/6-v10.png 2980w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h4",null,"CLI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Execute the following command to list the schemas in your Schema Registry:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schemas\n\nSchema                 State    Latest version   Latest version ID   Updated   \ndemoSchema_CLI_USER1   active   1.0.0            1                   Fri, 24 Jul 2020 13:55:49 UTC   \ndemoSchema_UI_USER1    active   1.0.0            1                   Fri, 24 Jul 2020 13:55:51 UTC   \nOK\n\n")))),Object(r.b)("h3",null,"Delete schemas"),Object(r.b)("h4",null,"UI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the schema you want to delete.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the ",Object(r.b)("em",{parentName:"p"},"Manage schema")," tab at the top.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Remove schema")),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"48.26388888888889%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdUlEQVQoz51Ry07DMBDMH9KHQJyAr0II9cCfIHFBHCuVE7RpXk2a1HGaOM6jSYa1aaq2EkhgaeT1ej076zFubu9weXWNi8EAw+EQo9EI4/FYxwPK/RUG4yksN4TreeA8RpalCAIfZVniP8soComSUJQVvIDBDzlyWaJtW12g9qZp9H4OlT+H4a88mOYClmVhvjAxn5twHBeu68K2bTDGSHWGNE1PoHI9hBCH2GAxx8pfww9CBOsIYRgijmNst1skSYKiKFBVlf6CY6i8IurJ+tjIRIEkLRAnUu+5JOQ5pJSo61o/rgg1kR5AeVWj1CtEUaSba8JNzGDT2JbnwnEdrVAVcM4PagSRczIrERk1TvTIvXJF3jf+HpncdWbviD4+wYKAFErsdrsT5ySNv5xOqW6GtblEQmel8HipN5owe30De5hoVGSK8rahS+0kudbRuVwswSZP2Nw/Qjy/6Fx75HzXdVqlJlSdBCHbf+qP2Nf9VqMIvwBO8Nj29qAi7wAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"7",title:"7",src:"/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/3cbba/7-v10.png",srcSet:["/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/7fc1e/7-v10.png 288w","/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/a5df1/7-v10.png 576w","/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/3cbba/7-v10.png 1152w","/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/0b124/7-v10.png 1728w","/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/4ea69/7-v10.png 2304w","/refarch-eda/static/97768ec5ec356afb67d486ce9bd42f2c/35b35/7-v10.png 2308w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"To remove a schema using the CLI, simply execute the following command and confirm:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Change USER1")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-remove demoSchema_CLI_USER1\n\nRemove schema demoSchema_CLI_USER1 and all versions? [y/n]> y\nSchema demoSchema_CLI_USER1 and all versions removed.\nOK\n")),Object(r.b)("h3",null,"Create new schema version"),Object(r.b)("p",null,"To create a new version of a schema, "),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Let’s first create again the previous two schemas:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Change USER1")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-ui.avsc\n\nSchema demoSchema_UI_USER1 is active.\n\nVersion   Version ID   Schema                State    Updated                         Comment   \n1.0.0     1            demoSchema_UI_USER1   active   Fri, 24 Jul 2020 13:59:55 UTC      \n\nAdded version 1.0.0 of schema demoSchema_UI_USER1 to the registry.\nOK\n")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-cli.avsc\n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema                 State    Updated                         Comment   \n1.0.0     1            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:00:45 UTC      \n\nAdded version 1.0.0 of schema demoSchema_CLI_USER1 to the registry.\nOK\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Add a new attribute to the schemas by editing their Avro schema avsc files:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Change USER1")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'cat demoshema-ui.avsc\n\n{\n"type":"record",\n"name":"demoSchema_UI_USER1",\n"namespace": "schemas.demo.ui",\n"fields":[\n    {"name": "eventKey","type":"string"},\n    {"name": "message","type":"string"},\n    {"name": "attribute1","type":"string"}]\n}\n')))),Object(r.b)("h4",null,"UI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the schema you want to create a new version for.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the ",Object(r.b)("em",{parentName:"p"},"Add new version")," button on the left hand side.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Upload definition")," button on the left hand side.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Select the Avro schema avsc file and click ok."),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"49.30555555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABd0lEQVQoz5VSu27CQBD0LwcDEUFI1BSp0qM0+QZLqdMiCh5pwBhMkJ/YvvMTicnuCQeHRJFiaXS7d7Ozs3fWeg8D3PcGaLVa6HQ60HVdod1u/wmdwPzhcIh+v49ut6tyrShKxImAEBJFUeA/3+l0gmEYmM1miKIIeZ5DOxwOsDYmPmwL+/0e290Oa9NEeDxCSEnNEoWkhrjktPq+rwQnkwls24brutBMO8Db1MZi7SOOY7yMx3gcjWCtVqiyDEkYIg4ChYgEakjiSmp4Pp9RVRUy4qZpCu11muHuucSTUUIQKd1Y2C3fsZnPFbaLJaz5Qq0eOXfXJjxCFoRqgtq5EEJBy1KJMk9Qlanq6JDtI43LsSQCxyG546KcXLCTLM3UnUsplCgLKT5B4yQR8qtDQMV1rM74Dsl5c48fkSHlta4heO3AxXyx9Qi853keHMf5JqjOhLi6bArKhmVeWZB/gTpP+LVvxJqufji8FWy6kxcnNfkW4pezT3x52aC8NrhAAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"8",title:"8",src:"/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/3cbba/8-v10.png",srcSet:["/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/7fc1e/8-v10.png 288w","/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/a5df1/8-v10.png 576w","/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/3cbba/8-v10.png 1152w","/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/0b124/8-v10.png 1728w","/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/4ea69/8-v10.png 2304w","/refarch-eda/static/f62345eccbe63f5d0866a10e874a9219/a50a4/8-v10.png 2898w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)(p,{kind:"error",mdxType:"InlineNotification"},Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"ERROR:")," The error we are seeing on the screen is because the IBM Event Streams Schema Registtry enforces full compatibility: ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://ibm.github.io/event-streams/schemas/creating/#adding-new-schema-versions"}),"https://ibm.github.io/event-streams/schemas/creating/#adding-new-schema-versions"))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Full compatibility")," for data schemas means that messages that have been serialized with an earlier version of a schema can be deserialized with a later version. To be compatible, fields in later versions of a schema cannot be removed, and any new schema field must have a default value. More on data schema compatibility on the section ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#data-evolution"}),"Data Evolution")," towards the end of this lab."),Object(r.b)("p",null,"As explained in the error notification above, we need to add a default value for our new attribute in our data schema so that messages serialized with an older version of the data schema which won’t contain this new attribute can later be deserialized with the newer version of the data schema that expects such attribute. By providing a default value, we allow deserializers to consume messages that do not contain newer attributes."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Add a default value for the new attribute:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Change USER1")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'cat demoshema-ui.avsc\n\n{\n"type":"record",\n"name":"demoSchema_UI_USER1",\n"namespace": "schemas.demo.ui",\n"fields":[\n    {"name": "eventKey","type":"string"},\n    {"name": "message","type":"string"},\n    {"name": "attribute1","type":"string","default": "whatever"}]\n}\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Repeat the steps for adding a new version of a schema above.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"This time you should see that the schema is valid:"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.44444444444444%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOklEQVQoz5VQzW6CQBjcF66AEmtaryZ9ij6BSS+cGp/AiwcTLo3VBEIpoLC7LP4cmPKtgaw/TVqSYfdjZ2aHYcPHJ7jDZ/R6PfT7fdi2/Sc4jgPLsjAajTAej+G6LgaDAdjheAQXErIssd/v8d/H933MZjPsdjsIIcCiKMJq9Ykw2CAMQ8RxjCAIkGWZJnDO76IoClRVhfl8Ds/zsF6vtY4FUYaFH+Jjk+iU0+kUk8kEy+USdV1DSqkNyJz2LcqGS+vpdNI8Miew94XCw+sBL28H5FziO/5CkqadiJJst1vkeX5hKMT5nC4yL2NSNiJeolSVJpBYKdURKF3bj2moezeS0kpg9FKKhjOBuqNULYH2WZrd/rL8xfC6lyRJdCJNoPSiQJKnTR15J77X5UVCEyaxncXVt2u+Of8A23+ON7tRKoUAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"9",title:"9",src:"/refarch-eda/static/08af945aea274d686726437e65992963/3cbba/9-v10.png",srcSet:["/refarch-eda/static/08af945aea274d686726437e65992963/7fc1e/9-v10.png 288w","/refarch-eda/static/08af945aea274d686726437e65992963/a5df1/9-v10.png 576w","/refarch-eda/static/08af945aea274d686726437e65992963/3cbba/9-v10.png 1152w","/refarch-eda/static/08af945aea274d686726437e65992963/0b124/9-v10.png 1728w","/refarch-eda/static/08af945aea274d686726437e65992963/4ea69/9-v10.png 2304w","/refarch-eda/static/08af945aea274d686726437e65992963/f3969/9-v10.png 2822w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"However, it still does not let us add this new version to the data schema until we actually provide a version for it. Click on the ",Object(r.b)("em",{parentName:"p"},"Add +")," link on the right of the version attribute of the schema and give it ",Object(r.b)("inlineCode",{parentName:"p"},"2.0.0")," for example (hit enter for the version to take the value you type in).")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Add schema"),".")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You should now see the two versions for your data schema on the left hand side."),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.388888888888886%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABUklEQVQoz6WRzUrDQBRG83T1YaoummJD0YC4j5CHEETbZbdduiuC2FWlDQZJ05Rkktb8TCefc8c2RpFacOAwzOTecz8mWqNxhPOLSzSPT6C3WtB1He12G4ZhHESH6HyhmaYJWnnBIYSQlPjP0oyuidu7HqxrG7Ztw7IsDAYDcM6RZZmiKApFnufVLsrPwXMGXN3nMG4K9B7eoZ11uvA8D+PxM2aOg+l0Js9zlLKBMYY0TZW83Ap2uyNr+/0+Ro9PcAMOdykQsAJa87QFbxHBeX3DYsngBxGWYaIakyRBHMdqJ3GVTj6N67oYDod4mUwgeAqIHKXg0Ogn0IpkGiWQrNdrJaTk1Oj7fiXeDaEBVEMDGIuRqeeoCdlWmNSEURQpKX2ju9VqVVFPT1B6epq9wjAMVcIgCCrJb5CYkv4prKf4mXAH3R+UcLPZfIOK90E1lPIDvwDSjOXajjcAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"10",title:"10",src:"/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/3cbba/10-v10.png",srcSet:["/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/7fc1e/10-v10.png 288w","/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/a5df1/10-v10.png 576w","/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/3cbba/10-v10.png 1152w","/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/0b124/10-v10.png 1728w","/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/4ea69/10-v10.png 2304w","/refarch-eda/static/a07ba9ddb9aaac4ef1d02a1aadf76852/6672f/10-v10.png 2928w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"If you go back to the Schema Registry page where all your schemas are listed, you should now see that the latest version for your data schema is ",Object(r.b)("inlineCode",{parentName:"p"},"2.0.0")," now."))),Object(r.b)("h4",null,"CLI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"If we try to add the new version of the schema from its ",Object(r.b)("inlineCode",{parentName:"p"},"demoschema-cli.avsc")," Avro schema file, we will get the same error as in the previous UI example:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-cli.avsc\n\nFAILED\nEvent Streams API request failed:\nError response from server. Status code: 400. Avro schema is not compatible with latest schema version: Compatibility type 'MUTUAL_READ' does not hold between 1 schema(s) in the chronology because: Schema[0] has incompatibilities: ['READER_FIELD_MISSING_DEFAULT_VALUE: attribute1' at '/fields/2'].\n\nUnable to add version 1.0.0 of schema demoSchema_CLI_USER1 to the registry.\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Add the default value for the new attribute in your Avro schema avsc file and try to add that new version of the schema:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-cli.avsc\n\nFAILED\nEvent Streams API request failed:\nError response from server. Status code: 409. Schema version name already exists\n\nUnable to add version 1.0.0 of schema demoSchema_CLI_USER1 to the registry.\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"We see that we still have an error because we have not specified a new version value. Specify a new version value when adding this new version of the schema:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-add --file demoshema-cli.avsc --version 2.0.0\n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema                 State    Updated                         Comment   \n1.0.0     1            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:00:45 UTC      \n2.0.0     2            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:09:37 UTC      \n\nAdded version 2.0.0 of schema demoSchema_CLI_USER1 to the registry.\nOK\n")))),Object(r.b)("h3",null,"Get latest version of a schema"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"In order to see the latest version of a data schema using the UI, we just need to go to the Schema Registry web user interface and click on the expand arrow buttton that is on the left:"),Object(r.b)("p",null," ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"60.416666666666664%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABPklEQVQoz6VSbU6DQBDdy9XT+KuQYghCPIkX8DD+MlET0ygIFGhhl4W0fDyZNdsiaWOrk7zMzuzOzNuZYbPZFVzXxWKxgG3b8DwPjuMoWJal/FqfA+a6tyCp6xq73Q7/FWY73qB6iLKElBLloIUQR1EUBTjnI5ujlhwvHxzX9wJ3DwLMurGHJALL5RJRFCFN06NIkgS+72O1Wik7yzKEYYgg8BHGKR5fUzy9ZWCmaSqqVHm73aLv+5Pfmd51XYe2bccesPl8ro6bzQZVVakHFDgFBTdN88NHNvX9+36wh9h9wjzP1WAoULOZYlyMhGydUBdlhmGoS+oRNZ0GQ0zPhX6vtUpImYMgUA3Xk7wUmsyeYRzHWK/XJ1fmd/ADQxJaAfr2X9gR8mEny1IehkKUaakvhZQlCiHx/J7jM63wBXjMciMLqGy5AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"11",title:"11",src:"/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/3cbba/11.png",srcSet:["/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/7fc1e/11.png 288w","/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/a5df1/11.png 576w","/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/3cbba/11.png 1152w","/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/0b124/11.png 1728w","/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/4ea69/11.png 2304w","/refarch-eda/static/6528021d9ff3274eb218b6977c4e124e/52c7d/11.png 2896w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"In order to see the latest version of a data schema using the CLI, we simply need to run the following command:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'cloudctl es schema demoSchema_CLI_USER1 --version 2\n\n{\n  "type": "record",\n  "name": "demoSchema_CLI_USER1",\n  "namespace": "schemas.demo.cli",\n  "fields": [\n    {\n      "name": "eventKey",\n      "type": "string"\n    },\n    {\n      "name": "message",\n      "type": "string"\n    },\n    {\n      "name": "attribute1",\n      "type": "string",\n      "default": "whatever"\n    }\n  ]\n}\n')),Object(r.b)("p",null,"(","*",") The version you specify is actually the version ID (2) rather than the version name we gave to the newer schema version (2.0.0):"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema demoSchema_CLI_USER1\n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema                 State    Updated                         Comment   \n1.0.0     1            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:00:45 UTC      \n2.0.0     2            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:09:37 UTC        \nOK\n")),Object(r.b)("h3",null,"Get specific version of a schema"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"To see a specific version of a schema, go to the Schema Registry web user interface and click on the schema you want to see the version for. You will now see how many version of the schema you have and you can click on any of these in order to see more details about it."),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.583333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHklEQVQoz62RTU6EQBCFOd14mYnKXwQjLlyLwZ0nUGNM2LvzCmPcsWQgQAg/A4FG4NnVkx5nzCxcWMmXSnX1e13drSwWJ3Cub7BcnkLXdRiGAdM0Ydv2n7AI6wfFca5AMXxN+I9QLmwHzy+vuL27h+d5cF0Xvu9jGAZ0XXeUvu85DJgZ3j8Z7EeGyyeGh7cOiqpbWK9DfKxWCIJAEIahOK1pGpRliaqqUNe1yEVRCFMZTQ/ExZakHKGcnWsoqxpxHAnRZrMRRvM8izrP811NTNN0ACCZOdxQ0zRxEolJSLRtK9bSNEUURSInSSIykWXZAdRruGYcJ35ldWtI16Hp5IQUsiZIRMiJ96E+vTlNzA3Vo4a0YR/G2I7fPQl91jcIyjvmmISpsgAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"12",title:"12",src:"/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/3cbba/12-v10.png",srcSet:["/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/7fc1e/12-v10.png 288w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/a5df1/12-v10.png 576w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/3cbba/12-v10.png 1152w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/0b124/12-v10.png 1728w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/4ea69/12-v10.png 2304w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/752f5/12-v10.png 2926w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"To see a specific version of a schema using the CLI, simply run the following command with the version ID you would like to get retrieved:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'cloudctl es schema demoSchema_CLI_USER1 --version 1\n\n{\n  "type": "record",\n  "name": "demoSchema_CLI_USER1",\n  "namespace": "schemas.demo.cli",\n  "fields": [\n    {\n      "name": "eventKey",\n      "type": "string"\n    },\n    {\n      "name": "message",\n      "type": "string"\n    }\n  ]\n}\n')),Object(r.b)("h3",null,"Listing all versions of a schema"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"To list all versions of schema in the Schema Registry user interface, you simply need to click on the data schema you want and a new page will display these:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.583333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHklEQVQoz62RTU6EQBCFOd14mYnKXwQjLlyLwZ0nUGNM2LvzCmPcsWQgQAg/A4FG4NnVkx5nzCxcWMmXSnX1e13drSwWJ3Cub7BcnkLXdRiGAdM0Ydv2n7AI6wfFca5AMXxN+I9QLmwHzy+vuL27h+d5cF0Xvu9jGAZ0XXeUvu85DJgZ3j8Z7EeGyyeGh7cOiqpbWK9DfKxWCIJAEIahOK1pGpRliaqqUNe1yEVRCFMZTQ/ExZakHKGcnWsoqxpxHAnRZrMRRvM8izrP811NTNN0ACCZOdxQ0zRxEolJSLRtK9bSNEUURSInSSIykWXZAdRruGYcJ35ldWtI16Hp5IQUsiZIRMiJ96E+vTlNzA3Vo4a0YR/G2I7fPQl91jcIyjvmmISpsgAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"12",title:"12",src:"/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/3cbba/12-v10.png",srcSet:["/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/7fc1e/12-v10.png 288w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/a5df1/12-v10.png 576w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/3cbba/12-v10.png 1152w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/0b124/12-v10.png 1728w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/4ea69/12-v10.png 2304w","/refarch-eda/static/97de55f65ac974ac3ef73a6406940a42/752f5/12-v10.png 2926w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"In order to display all versions of a schema, run the following command:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema demoSchema_CLI_USER1\n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema                 State    Updated                         Comment   \n1.0.0     1            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:00:45 UTC      \n2.0.0     2            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:09:37 UTC        \nOK\n")),Object(r.b)("h3",null,"Deleting a version of a schema"),Object(r.b)("h4",null,"UI"),Object(r.b)("p",null,"In order to delete a version of a schema using the Schema Registry user interface,"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the data schema you want a version of it deleted for.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Select the version you want to delete on the left hand side.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Manage version")," button that is on the top right corner within the main box in the center of the page.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Remove version"),"."),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"48.611111111111114%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABr0lEQVQoz61SPU8bQRC9H+f/QhQFnwM2JLFSUmLFSoMEEiXIiIKkj1KgyAZE4cpyYwLGZ8734bvd+/L67jGzso0rRMFKT7szu/PmzewYpVIJX759x8aHjyiXN2GapkatVkO1Wn0Ttrer2FrAqNfr4JUXeJdl1HbrOG2do/HjJ5rNJhqNBlqtFrIs00iSBLPZTIPt5XmJIle4uAX2LoD93xkR7nyFZY3Q7XbR7/fR6/UwGAxQFAWiKEIcJ/rMWF9sK6XoTYyTX20cnnXQG85glM0KgiAkUgtSyhU4YDr1MR5bmEwm8D0PQgjM5/MVISsWMkK7c4Xrqw45ifDTpqlV2LYNj4Jc14Xv+zogCCUc1ydMdVIpBb2NNRGrY6RpslKd00cYnysVbYRhuFLHpRZFTtljTJwpHC+ApNJYnSai3qlFDzkBx7L6PM9hVBaEQRBoJ2NZsjUeY/D/DsPHIeynJx3IBOy/u7/HcDSC4zjan6bpK4QE/gL38h9Gh8fwbm4hqDRJgRER2n/+4uHgCHbnGoKmQCwSvapQjwXtmevpXc3Vy7gIuvd8KGqNojasj9Ezt0LNyRQOwjAAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"13",title:"13",src:"/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/3cbba/13-v10.png",srcSet:["/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/7fc1e/13-v10.png 288w","/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/a5df1/13-v10.png 576w","/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/3cbba/13-v10.png 1152w","/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/0b124/13-v10.png 1728w","/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/4ea69/13-v10.png 2304w","/refarch-eda/static/cf7b9111ff2f523531a71ff1c2805658/1d0e3/13-v10.png 2930w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("h4",null,"CLI"),Object(r.b)("p",null,"In order to delete a version of a schema through the CLI, execute the following command:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema-remove demoSchema_CLI_USER1 --version 1\n\nRemove version with ID 1 of schema demoSchema_CLI_USER1? [y/n]> y\nVersion with ID 1 of schema demoSchema_CLI_USER1 removed.\nOK\n")),Object(r.b)("p",null,"We can see only version 2 now:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"cloudctl es schema demoSchema_CLI_USER1\n\nSchema demoSchema_CLI_USER1 is active.\n\nVersion   Version ID   Schema                 State    Updated                         Comment   \n2.0.0     2            demoSchema_CLI_USER1   active   Fri, 24 Jul 2020 14:09:37 UTC      \nOK\n")),Object(r.b)("h2",null,"IBM Event Streams Credentials"),Object(r.b)("p",null,"We have seen how to interact with the IBM Event Streams Schema Registry in order to create, delete, update, etc schemas that our applications will theoretically used for data correctness and application robusteness. However, the first thing that we need to set up in our IBM Event Streams instance are these applications’ ",Object(r.b)("strong",{parentName:"p"},"service credentials")," to be able to interact with IBM Event Streams and its Schema Registry. For doing so, we can either use either the GUI or the CLI."),Object(r.b)("h3",null,"GUI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Go to you IBM Event Streams instance console"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"55.55555555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABiElEQVQoz3VSy07CUBDtXxrjrxgX9gUJG8EfcO0XuDRqjDGYSFyggQikYBTo+0Gh5dhzzW0K1ElO5nFnzp2ZjHJ0fIJOu41Go4FWq4VmsylsTdMEDF0vfLOwdZyrGk7PzqFrahHXBGSeaZqiVml3LkHZbreoE0bdICl913GRFTrNgbwmX1FVFcvlEv1+H8PhUNiO48C2bQS+h/fBGA/Pb3j9DHFxk6A7CGFNZ7jvDtD7mMH3/nJZQyiGYQjm+XwuAp7nwfd9AbewV3GA25cZHnsWrp9SXN2lsKwJxuMJPNdBEARlPqFwfkoYhlitVojjGFEUCS0x/frGcvEDZMV7FCBJYqRpWuikJKQmFL1YOoUJ3OP+LvM839lnvvfOzw8I1+s1RqORGJsdMYGJjPMj13VFN5vNRkxBX75zsh3C6sgsyLJM2LJjan7COH0SS5/d13ZIYULt2eyNKH2p/yXkubAbgjbH4kjsaLFYiK44AQl4DSxmLn1JdkAoT4a6ej5VW6J6LrZjlzW/X34pidhXTOEAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"1",title:"1",src:"/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/3cbba/1.png",srcSet:["/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/7fc1e/1.png 288w","/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/a5df1/1.png 576w","/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/3cbba/1.png 1152w","/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/0b124/1.png 1728w","/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/4ea69/1.png 2304w","/refarch-eda/static/1e965a04cc0c6aa3bff4e8188d82554f/5aa31/1.png 3840w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("strong",{parentName:"p"},"Connect to this cluster")),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"55.55555555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABpUlEQVQoz21SXU/CQBDsv9T4V4wPSgsl4UX0D/jsH/DVqDGaaKLxAQ1EJIBRoLS9ftMy7hwpVuSSye5d9+Zmtmvs7O6h3W6j0bDRarVg27aGaZoalmXCbtR1fnhkYv/gEGatps8JntcE9XodzWYTRvvkFFzL5RLbFk9dFa/3rusil5gWQLGl3qjJa7PZDJ1OB71eT+fz+RyO40D5Hl67H7i5f8HTe4DjixgP3QDD0RjXD108v43he6ta3iEMSuWaTCb6wPM8+L6v4UqeRAqXj2PcPg9xfpfi7CrDcDjAx2AgtS6UUut6wmAPuIIgQJIkiKIIYRjqWGL0+YXZ9BvIE8SiKFYe0jCQ6ENRgJAqISO5YVmWJkzTVPdxs5dF8dsp/V3qKh8Risp/hFmWod/va9tUROlUyXM+xB8RxzEWsk8CBVdaE4qjLIkRuhuEVcuLxQJ5nuu8VMzIR3JRwz1tRmIzl/YUglCtekeyP5ZJtHVsNlqw3Ih0spWQ40I1BHPapGVanU6nWiUdkIDToEQZa7kvyf4RliPDWB2fal6iOi7O3Fnf+QFQnij0iQeDrAAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"2",title:"2",src:"/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/3cbba/2.png",srcSet:["/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/7fc1e/2.png 288w","/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/a5df1/2.png 576w","/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/3cbba/2.png 1152w","/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/0b124/2.png 1728w","/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/4ea69/2.png 2304w","/refarch-eda/static/d646475ed1d95f47ab56e10dfa2b48b4/5aa31/2.png 3840w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("p",null,"In this panel, you will find"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"The ",Object(r.b)("strong",{parentName:"p"},"Botstrap server")," to connect your applications to in order to send and receive messages from your IBM Event Streams instance. We can see we have one ",Object(r.b)("strong",{parentName:"p"},"external listener")," (whith SCRAM-SHA authentication) and one internal listener (Depending your IBM Event Streams installation you might have different listeners and authentications for these).")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"The ",Object(r.b)("strong",{parentName:"p"},"Schema Registry url")," your applications will need to work with Apache Avro data schemas.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A ",Object(r.b)("em",{parentName:"p"},"Generate SCRAM credentials")," button to generate the ",Object(r.b)("strong",{parentName:"p"},"SCRAM credentials")," your applications will need to authenticate with.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A ",Object(r.b)("em",{parentName:"p"},"Certificates")," section to download either the ",Object(r.b)("strong",{parentName:"p"},"Java PKCS12")," or the ",Object(r.b)("strong",{parentName:"p"},"PEM")," certificates (or both) that your applications will need in order to be able to establish the communitaction with your IBM Event Streams instance."),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"118.75%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAABYlAAAWJQFJUiTwAAADD0lEQVQ4y61VS0sbURjN73QluBHEhRtXirhzU7CLStNFShct3bkqiG3TqhREUKGFdOEzLxMnmWSemZk7mZze8yU3nYqPFnrhMHdmvnvu+V73FjzPQ6lUQrFYxObmJvb29pCmKQaDAZIkQRzHMo+iSL5zjEYjwX2j0O/3sbGxgfX1dSwtLWF7exthGMJxHCEMggC0cV0XSqmnCZNEYTgcIssy+UBFJOj1erBtG91udwpuZAgfGoUoitHpdOD7voCK6CI3MEo4N+9PKmRsLi4ucHZ2hmq1ivPzc3mnOqok6D7f8wofQoEudrsdrdJCGPhIJkkwipk0EnF+Nyn3EiqVwu57aFs9xNo+056QUE0W/+uQpLQ7LmrNDhotWxPbsCxLkkA386A3DM3a2hpWVlawuroqWF5exsLCAk5OTqhQYZTpLA9TwVArS++ANgQTQ9dPT09xfHz8B46OjmTTgqmt/zUkKVdXV6jX69INBowj/+W/sV7zZXQXuSx3ZYEhIJlpN/POpyn+xzJdYElUazU0Gg2pQ5ZJnsgoZaIuLy9xfX0tncR1ebAhaCeEdNmAgfX8AI7rT+F6gfbCRrPZlI1brZb0Nr8bm77jIxxEKFBB33HRtfvydLQRkOYw1FCIBoFWMlYcaBGDUNtlvvZ9AngaE0IaBhqeH+pOCfCtEqFUTvDuIMabLzFel2M0LN3joadV+dJRlu3j/UGk/0d4ux9haydC+YcaJ+V3vY1V7f/M8HwHeFUGtj4CLz8BlquVZinkdEoVnECh9HWEF7tA8fMIzz6MsPt9UjaMSbvdxs3NDdq3FnpWAyq4nbis5JkN1bSXn6xDBpp1yKCTtN5oolZvotW2pklh9mnLWjSZ9YNQwkTQJtEeSqewnSRrE7AszCFLcG56uVKpYHFxEfPz89K/c3NzmJ2dxczMDA4PD8eEBI97g8cKmG7zfDQwmxNcOz1gCRYun+wcuki14yoYu/g3fS8x5BVgjiwzZ6LM1UBywlwPphW5lqAybkj14rIUqzY2MHeLia0hNKoJEphrNk/4C2zvG8muuI/uAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"3",title:"3",src:"/refarch-eda/static/f8bd804eb054576577687f8fc5d8c256/3cbba/3-v10.png",srcSet:["/refarch-eda/static/f8bd804eb054576577687f8fc5d8c256/7fc1e/3-v10.png 288w","/refarch-eda/static/f8bd804eb054576577687f8fc5d8c256/a5df1/3-v10.png 576w","/refarch-eda/static/f8bd804eb054576577687f8fc5d8c256/3cbba/3-v10.png 1152w","/refarch-eda/static/f8bd804eb054576577687f8fc5d8c256/52c65/3-v10.png 1614w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("p",null,"To generate the SCRAM credentials needed by your application to get authenticated against IBM Event Streams to be able to produce and consume messages as well as to create, delete, etc topics and schemas, we need to create a ",Object(r.b)("strong",{parentName:"p"},"KafkaUser")," (this happens behind the scenes) which we will set some permissions and get the corresponding SCRAM usernname and password for to be used in our applications kafka clients configuration:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on ",Object(r.b)("em",{parentName:"p"},"Generate SCRAM credentials"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Enter a user name for your credentials and click next (leave the last option selected: ",Object(r.b)("em",{parentName:"p"},"Produce messages, consume messages and create topics and schemas")," so that we give full access to our user for simplicity)"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"47.22222222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABMElEQVQoz4WSW07DMBBFs6zyyzKaNFI+2AV0pSHvJ4mTxnZAUKqLZ4xRVYj4OLoTx76eh704jpGmKZIkQZ7naNsWTdOgLCv0fY9pmiDEhPEbIQTmeWYotv+tDsMAj8ys4TOblmWJoih4jczHceCNIzESo/02qrXGuq6sDi/LcjbpOspmhlIaUimLlDgtCxZG/kIZA2X2XeNVrUAvzOH1DPX6afXtAuli0j+g9UWfsUjKTHEibEjZUWl13aCqaxN3eDElUVZUgvy5XW/iDG3JpldVVfJAyNz1kPpERq43t6WpjYvMUDJjWLGJU2fcdR03n6a4rmYAJpP/8KhcegI0dvccXHz9JKaTxrRozAaON/CiKEIYhvB9H0EQ3HDAIdhjHz7g/iiwO16we3zH3dPHJl+Tuo1V77C4OAAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"scram1",title:"scram1",src:"/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/3cbba/scram-1-v10.png",srcSet:["/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/7fc1e/scram-1-v10.png 288w","/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/a5df1/scram-1-v10.png 576w","/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/3cbba/scram-1-v10.png 1152w","/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/0b124/scram-1-v10.png 1728w","/refarch-eda/static/56fda38505c112844b6a2bb4a487bf04/bed37/scram-1-v10.png 1848w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Select all topics and click next"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"40.625%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/klEQVQoz43RS06EQBAG4L6DnmBOYYSFCSsvovG+kJHhIbDh1SyA5jUZ+KVKIWEwxMWXoruqi6IRlmXBcRzYtg3P8xBFEYIgwFcQIgxDXsdxjDRNWZIkyPOcZVkGKSWKomCUF67r8gFKLqhYypyL6VkphbZt0TTNIarjhtS5qio+RJv36rr+N0HT0bg0CTXt+35nGIY/UW554RIF3RE1oynLsjz4pHZHzapabQi6p67ruDvFcRwxTdOdee82ALd+Y5pde4Whq3H9JUzThO/7/Kf33J/oerhEFc5RM1OrT9ZsCMMwoOs6NE1b42pe689P0F5ecfoo8PAOPL6Nh74BBkY8yD3dJ2gAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"scram2",title:"scram2",src:"/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/3cbba/scram-2-v10.png",srcSet:["/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/7fc1e/scram-2-v10.png 288w","/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/a5df1/scram-2-v10.png 576w","/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/3cbba/scram-2-v10.png 1152w","/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/0b124/scram-2-v10.png 1728w","/refarch-eda/static/4ccc4639011ce5f5cde1e589de1d9a08/621ef/scram-2-v10.png 1854w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Select all consumer groups and click next"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"40.27777777777778%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA80lEQVQoz43QW2qEMBgF4OxguoLZRhkLBR+6kpauVphi9c28iHgXb4mo4/Q0f0BH6wxU+Egi/IeTMM45giCA7/sIwxBpmiJJEo32syzL0LYthBDLOpvPVVWBeZ63G8zzfLMnRVFsQv6aQxk1pDZxHOshKeVDNHTPOpRFUYSyLHUYtarrGuM4YhiGf1m304H0dtSQgukN6Zp3r6UaCtHdSFolmlagaW4YNev7Xl+JBruuwzRN2H3XQel3Lr1Q2gWzLAuu68JxnIVt21vf6h+vcfbkzhffYqZpwjCMB15gnJ5xen3D8TPD4QN4er8qP4uDOq/9AmhIO+fdnlYSAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"scram3",title:"scram3",src:"/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/3cbba/scram-3-v10.png",srcSet:["/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/7fc1e/scram-3-v10.png 288w","/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/a5df1/scram-3-v10.png 576w","/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/3cbba/scram-3-v10.png 1152w","/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/0b124/scram-3-v10.png 1728w","/refarch-eda/static/f8fa18354b051e2bb918c699f402c894/84ddc/scram-3-v10.png 1850w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Select all transactional IDs and click next"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.79166666666667%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRElEQVQoz4WQy07CUBCGu3etT0JS4oKVD6IujA8pCRsodCVxI9hAKZxCaRvo/ZLQ3zOjXKo1NvkymZl//jNT5X0ygWEYmE6nmM1msBYLmOYC87kpownLsri2XApsNo5kA9d14fs+PM87QbnjOFBIvF6vWUgFEpNgu91yTkKq7XY7pGmKJEn+JI5jKMZ8+TUsDff7PQ9R4yS6EEdR9C/K5MPESggIseKNqEgGTWIybeLYY0PPcxGGIZ9EGwZBwHlRFCjLkmMTx96lIZ8shM3/UMgtbdvm88n850ZRnDYShHENhQbpJTozyzLkec55VVWofVUhyc+AYoaqjHC4QOn3+9B1HaPRiBkOh4ymad8MMNB09MYBem+pJEH3NcGLpDsm0hpKp9NBu92Gqqq/kfW22kLr9g43jz6un4HrpwOuHqoz93U+ATccg7ZRnEDqAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"scram4",title:"scram4",src:"/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/3cbba/scram-4-v10.png",srcSet:["/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/7fc1e/scram-4-v10.png 288w","/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/a5df1/scram-4-v10.png 576w","/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/3cbba/scram-4-v10.png 1152w","/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/0b124/scram-4-v10.png 1728w","/refarch-eda/static/2a561cc4d72cbbc9871f2e952b2b6210/d890f/scram-4-v10.png 1852w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("p",null,"Once you have created your new KafkaUser, you get the SCRAM credentials displayed on the screen:"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"90.97222222222221%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7klEQVQ4y51Uu47iQBD0P5KQsyEh/Al/QUiERECM2AAhJHSLQELsIr+fYPysc422WQMG7d1IxYxMu7q6usea67o4nU6IoghhGKrz+XxW539BEATwfR9almVXojRN4TgOdF1HWZb4n6WRbDKZYDweYzQaYblcXlUyWZIkiOMYl8sFeZ6rRK+gmaaJXq+HbreLdruN4XCoiCifimkFbWFiPueSl+Vcf6ZRAYP5ongpfpCoDiq9J3womUFU6XmeIiFIyERUyJ3lci+K4neEu90Om80G+/0e2+1WgQkkCRPwTOI6YROpxiDTNGAYOqIwQFw1g6ULkYC2sCm3CrkDdV4tTTM4bgDdsJFW8ayKHZbympc0oqHkJEmhWwEORxtfhg/T9mBbFmzbVjMpYFMiNq9SH1a9OSdPFaY4RSEcmySmIvI8X/nF/+qQRuWV+LwQwvKWkD+DwUDNYOftDZ1OB61WC/1+XzWCykThrRVlc8k0er1eYzqdYjabYbFYYD6fY7VaKUX3qDemsWROP4PkFlxtr6I4UgJawKEn6atZVApZElUej0dFTJ8kkUDu9ePoNBB+Hg54f5/j4+OPalAY/syeQBQy2UvCtMrq+hGcqIQV5PiyYljeT5lS8r0d9f2GMPvOWFRjwEl49hW8v27PFP4FxH1p6yyXVQQAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"scram5",title:"scram5",src:"/refarch-eda/static/31d66cef534a96a18ab1e4774cd92778/3cbba/scram-5-v10.png",srcSet:["/refarch-eda/static/31d66cef534a96a18ab1e4774cd92778/7fc1e/scram-5-v10.png 288w","/refarch-eda/static/31d66cef534a96a18ab1e4774cd92778/a5df1/scram-5-v10.png 576w","/refarch-eda/static/31d66cef534a96a18ab1e4774cd92778/3cbba/scram-5-v10.png 1152w","/refarch-eda/static/31d66cef534a96a18ab1e4774cd92778/52c65/scram-5-v10.png 1614w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(r.b)("p",null,"You can download the PEM certificate from the UI and then use the IBM Cloud Shell upload file option on the top bar or you can download it from within your IBM Cloud Shell by using the CLI (see below)")),Object(r.b)("h3",null,"CLI"),Object(r.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(r.b)("p",null,"The following two steps should have been completed already in the previous ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#accessing-the-schema-registry"}),"Accessing the Schema Registry")," section")),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Log into your cluster with the IBM CloudPak CLI"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'cloudctl login -a https://cp-console.apps.eda-solutions.gse-ocp.net --skip-ssl-validation\n\nUsername> admin\n\nPassword> \nAuthenticating...\nOK\n\nTargeted account mycluster Account\n\nEnter a namespace > integration\nTargeted namespace integration\n\nConfiguring kubectl ...\nProperty "clusters.mycluster" unset.\nProperty "users.mycluster-user" unset.\nProperty "contexts.mycluster-context" unset.\nCluster "mycluster" set.\nUser "mycluster-user" set.\nContext "mycluster-context" created.\nSwitched to context "mycluster-context".\nOK\n\nConfiguring helm: /Users/jesusalmaraz/.helm\nOK\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Initialize the Event Streams CLI plugin"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es init    \n                                              \nIBM Cloud Platform Common Services endpoint:   https://cp-console.apps.eda-solutions.gse-ocp.net   \nNamespace:                                     integration   \nName:                                          es-1   \nIBM Cloud Pak for Integration UI address:      No instance of Cloud Pak for Integration has been found. Please check that you have access to it.   \nEvent Streams API endpoint:                    https://es-1-ibm-es-admapi-external-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams API status:                      OK   \nEvent Streams UI address:                      https://es-1-ibm-es-ui-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams Schema Registry endpoint:        https://es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net   \nEvent Streams bootstrap address:               es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443   \nOK\n")))),Object(r.b)("p",null,"We can see above the Event Streams ",Object(r.b)("strong",{parentName:"p"},"bootstrap address")," and ",Object(r.b)("strong",{parentName:"p"},"Schema Registry url")," that our applications will need in order to connect to this Event Streams instance"),Object(r.b)("p",null,"To be able to establish communication and authenticate against your IBM Event Streams instance, you will need the PEM certificate and an the SCRAM credentials:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"To download your ",Object(r.b)("strong",{parentName:"p"},"PEM certificate"),", you can use the following command:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es certificates --format pem\n\nCertificate successfully written to /home/ALMARAZJ/es-cert.pem.\nOK\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"To generate your SCRAM credentials, we first need to create a ",Object(r.b)("strong",{parentName:"p"},"KafkaUser"),", you can use the following command:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es kafka-user-create --name my-user1 --consumer --producer --schema-topic-create --all-topics --all-groups --all-txnids --auth-type scram-sha-512\n\nKafkaUser name   Authentication   Authorization   Username                                                Secret   \nmy-user1         scram-sha-512    simple          EntityOperator has not created corresponding username   EntityOperator has not created corresponding secret   \n\nResource type     Name        Pattern type   Host   Operation   \ntopic             *           literal        *      Read   \ntopic             __schema_   prefix         *      Read   \ntopic             *           literal        *      Write   \ntopic             *           literal        *      Create   \ntopic             __schema_   prefix         *      Alter   \ngroup             *           literal        *      Read   \ntransactionalId   *           literal        *      Write   \n\nCreated KafkaUser my-user1.\nOK\n")))),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"We recommend to carefully set appropriate roles as well as access to topics, groups, transaction IDs and schemas for the API keys that you generate.")),Object(r.b)("p",null,"When a KafkaUser custom resource is created, the Entity Operator within Event Streams will create the principal in ZooKeeper with appropriate ACL entries. It will also create a Kubernetes Secret that contains the Base64-encoded SCRAM password for the scram-sha-512 authentication type, or the Base64-encoded certificates and keys for the tls authentication type."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Retrieve the username and the secret name containing the password of your SCRAM credentials for your KafkaUser:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'oc get kafkauser my-user1 --namespace integration -o jsonpath=\'{"username: "}{.status.username}{"\\nsecret-name: "}{.status.secret}{"\\n"}\'\n\nusername: my-user1\nsecret-name: my-user1\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Retrieve the password of your SCRAM credentials from the secret above:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"oc get secret my-user1 --namespace integration -o jsonpath='{.data.password}' | base64 --decode\n\n*****\n")))),Object(r.b)("h3",null,"Environment variables"),Object(r.b)("p",null,"Now that we have generated the appropriate IBM Event Streams credentials for applications to be able to establish communication and authenticate against our IBM Event Streams instance, we are going to set some environment variables that will be used by our Python application:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"KAFKA_BROKERS")," which should take the value of ",Object(r.b)("strong",{parentName:"p"},"bootstrap server"),":"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export KAFKA_BROKERS=es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"SCRAM_USERNAME")," which should take the value of the ",Object(r.b)("strong",{parentName:"p"},"SCRAM username")," you have generated:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export SCRAM_USERNAME=my-user1\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"SCRAM_PASSWORD")," which should take the value of the ",Object(r.b)("strong",{parentName:"p"},"SCRAM password")," you have generated:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export SCRAM_PASSWORD=*****\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"PEM_CERT")," which should take the value of the location where the PEM certificate is within your IBM Cloud Shell:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",{parentName:"li"},"Set the path appropriately to your IBM Cloud Shell")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export PEM_CERT=~/es-cert.pem\n")),Object(r.b)("p",{parentName:"li"},"(","*",") Don’t forget to download both the PEM certificate to your IBM Cloud Shell through the CLI or upload it to your IBM Cloud Shell from your laptop if you used the UI to get the certificate. Review previous section if needed.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"SCHEMA_REGISTRY_URL")," which should be a combination of the ",Object(r.b)("strong",{parentName:"p"},"SCRAM username"),", the ",Object(r.b)("strong",{parentName:"p"},"SCRAM password")," and the ",Object(r.b)("strong",{parentName:"p"},"Schema Registry url")," in the form of:"),Object(r.b)("p",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"p"},"https://<SCRAM_username>:<SCRAM_password>@<Schema_Registry_url>")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export SCHEMA_REGISTRY_URL=https://${SCRAM_USERNAME}:${SCRAM_PASSWORD}@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net\n")))),Object(r.b)("h2",null,"Python Application"),Object(r.b)("p",null,"The Python application we have built to see how to produce and consume messages (either plain messages or Avro encoded messages based on Avro Data Schemas) to and from an IBM Event Streams instance installed through the IBM Cloud Pak for Integration is public at the following GitHub repo: ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cp4i-schema-lab-v10"}),"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cp4i-schema-lab-v10")),Object(r.b)("h3",null,"Clone"),Object(r.b)("p",null,"In order to use and work with this Python application, the first thing we need to do is to clone the GitHub repository where it is published."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Clone the github repository on your workstation on the location of your choice:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"git clone https://github.com/ibm-cloud-architecture/refarch-eda-tools.git\n\nCloning into 'refarch-eda-tools'...\nremote: Enumerating objects: 185, done.\nremote: Counting objects: 100% (185/185), done.\nremote: Compressing objects: 100% (148/148), done.\nremote: Total 185 (delta 23), reused 176 (delta 16), pack-reused 0\nReceiving objects: 100% (185/185), 6.17 MiB | 4.61 MiB/s, done.\nResolving deltas: 100% (23/23), done.\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Change directory into ",Object(r.b)("inlineCode",{parentName:"p"},"refarch-eda-tools/labs/es-cp4i-schema-lab-v10")," to find the assets we will we working from now on for the python demo environment and few other scripts/applications:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cd refarch-eda-tools/labs/es-cp4i-schema-lab-v10\n\n$ ls -all\ntotal 240\ndrwxr-xr-x   9 user  staff     288 20 May 19:33 .\ndrwxr-xr-x   3 user  staff      96 20 May 19:33 ..\n-rw-r--r--   1 user  staff  112578 20 May 19:33 README.md\ndrwxr-xr-x   5 user  staff     160 20 May 19:33 avro_files\ndrwxr-xr-x   6 user  staff     192 20 May 19:33 kafka\ndrwxr-xr-x   6 user  staff     192 20 May 19:33 src\n")))),Object(r.b)("p",null,"In the next sections, we are going to briefly explain the implementation of this Python application so that you understand what is being done behind the scenes and more importantly, if you are a developer, how to do so."),Object(r.b)("h2",null,"Python Avro Producer"),Object(r.b)("p",null,"In this section we describe the Python scripts we will be using in order to be able to produce ",Object(r.b)("strong",{parentName:"p"},"avro")," messages to a Kafka topic."),Object(r.b)("h3",null,"Produce Message"),Object(r.b)("p",null,"The python script that we will use to send an avro message to a Kafka topic is ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab-v10/src/ProduceAvroMessage.py"}),"ProduceAvroMessage.py")," where we have the following:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A function to parse the arguments:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'def parseArguments():\n    global TOPIC_NAME\n    print("The arguments for this script are: " , str(sys.argv))\n    if len(sys.argv) == 2:\n        TOPIC_NAME = sys.argv[1]\n    else:\n        print("[ERROR] - The produceAvroMessage.py script expects one argument: The Kafka topic to publish the message to")\n        exit(1)\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A function to create the event to be sent:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'def createEvent():\n    print(\'Creating event...\')\n    \n    key = {"key": 1}\n    value = {"message" : "This is a test message"}\n    \n    print("DONE")\n    \n    return json.dumps(value), json.dumps(key)\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"The main where we will:"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},"Parse the arguments"),Object(r.b)("li",{parentName:"ol"},"Get the Avro schemas for the key and value of the event"),Object(r.b)("li",{parentName:"ol"},"Create the Event to be sent"),Object(r.b)("li",{parentName:"ol"},"Print it out for reference"),Object(r.b)("li",{parentName:"ol"},"Create the Kafka Avro Producer and configure it"),Object(r.b)("li",{parentName:"ol"},"Send the event")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'if __name__ == \'__main__\':\n    # Get the Kafka topic name\n    parseArguments()\n    # Get the avro schemas for the message\'s key and value\n    event_value_schema = getDefaultEventValueSchema(DATA_SCHEMAS)\n    event_key_schema = getDefaultEventKeySchema(DATA_SCHEMAS)\n    # Create the event\n    event_value, event_key = createEvent()\n    # Print out the event to be sent\n    print("--- Event to be published: ---")\n    print(event_key)\n    print(event_value)\n    print("----------------------------------------")\n    # Create the Kafka Avro Producer\n    kafka_producer = KafkaProducer(KAFKA_BROKERS,SCRAM_USERNAME,SCRAM_PASSWORD,SCHEMA_REGISTRY_URL)\n    # Prepare the Kafka Avro Producer\n    kafka_producer.prepareProducer("ProduceAvroMessagePython",event_key_schema,event_value_schema)\n    # Publish the event\n    kafka_producer.publishEvent(TOPIC_NAME,event_value,event_key)\n')))),Object(r.b)("p",null,"As you can see, this python code depends on an ",Object(r.b)("strong",{parentName:"p"},"Avro Utils")," for loading the Avro schemas and a ",Object(r.b)("strong",{parentName:"p"},"Kafka Avro Producer")," to send the messages. These are explained next."),Object(r.b)("h3",null,"Avro Utils"),Object(r.b)("p",null,"This script, called ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab-v10/avro_files/utils/avroEDAUtils.py"}),"avroEDAUtils.py"),", contains some very simple utility functions to be able to load Avro schemas from their ",Object(r.b)("strong",{parentName:"p"},"avsc")," files in order to be used by the Kafka Avro Producer."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A function to get the key and value Avro schemas for the messages to be sent:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'def getDefaultEventValueSchema(schema_files_location):\n# Get the default event value data schema\nknown_schemas = avro.schema.Names()\ndefault_event_value_schema = LoadAvsc(schema_files_location + "/default_value.avsc", known_schemas)\nreturn default_event_value_schema\n\ndef getDefaultEventKeySchema(schema_files_location):\n# Get the default event key data schema\nknown_schemas = avro.schema.Names()\ndefault_event_key_schema = LoadAvsc(schema_files_location + "/default_key.avsc", known_schemas)\nreturn default_event_key_schema\n')),Object(r.b)("p",{parentName:"li"},"(","*",") Where ",Object(r.b)("inlineCode",{parentName:"p"},"known_schemas")," is an Avro schema dictionary where all Avro schemas read get stored in order to be able to read nested Avro schemas afterwards. See the python script in detail for examples of this.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A function to open a file, read its content as an Avro schema and store it in the Avro schema dictionary:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"def LoadAvsc(file_path, names=None):\n# Load avsc file\n# file_path: path to schema file\n# names(optional): avro.schema.Names object\nfile_text = open(file_path).read()\njson_data = json.loads(file_text)\nschema = avro.schema.SchemaFromJSONData(json_data, names)\nreturn schema\n")))),Object(r.b)("h3",null,"Kafka Avro Producer"),Object(r.b)("p",null,"This script, called ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab-v10/kafka/KcAvroProducer.py"}),"KcAvroProducer.py"),", will actually be the responsible for creating the Kafka Avro Producer, initialize and configure it and provide the publish method:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Initialize and prepare the Kafka Producer"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"class KafkaProducer:\n\n    def __init__(self,kafka_brokers = \"\",scram_username = \"\",scram_password = \"\",schema_registry_url = \"\"):\n        self.kafka_brokers = kafka_brokers\n        self.scram_username = scram_username\n        self.scram_password = scram_password\n        self.schema_registry_url = schema_registry_url\n\n    def prepareProducer(self,groupID = \"pythonproducers\",key_schema = \"\", value_schema = \"\"):\n        options ={\n                'bootstrap.servers':  self.kafka_brokers,\n                'schema.registry.url': self.schema_registry_url,\n                'group.id': groupID,\n                'security.protocol': 'SASL_SSL',\n                'sasl.mechanisms': 'SCRAM-SHA-512',\n                'sasl.username': self.scram_username,\n                'sasl.password': self.scram_password,\n                'ssl.ca.location': os.environ['PEM_CERT'],\n                'schema.registry.ssl.ca.location': os.environ['PEM_CERT']\n        }\n        # Print out the configuration\n        print(\"--- This is the configuration for the avro producer: ---\")\n        print(options)\n        print(\"---------------------------------------------------\")\n        # Create the Avro Producer\n        self.producer = AvroProducer(options,default_key_schema=key_schema,default_value_schema=value_schema)\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Publish method"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"def publishEvent(self, topicName, value, key):\n    # Produce the Avro message\n    # Important: value DOES NOT come in JSON format from ContainerAvroProducer.py. Therefore, we must convert it to JSON format first\n    self.producer.produce(topic=topicName,value=json.loads(value),key=json.loads(value)[key], callback=self.delivery_report)\n    # Flush\n    self.producer.flush()\n")))),Object(r.b)("h2",null,"Python Avro Consumer"),Object(r.b)("p",null,"In this section we describe the python scripts we will be using in order to be able to consume Avro messages from a Kafka topic."),Object(r.b)("h3",null,"Consume Message"),Object(r.b)("p",null,"The python script that we will use to consume an Avro message from a Kafka topic is ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab-v10/src/ConsumeAvroMessage.py"}),"ConsumeAvroMessage.py")," where we have the following:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"A function to parse arguments:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# Parse arguments to get the container ID to poll for\ndef parseArguments():\n    global TOPIC_NAME\n    print("The arguments for the script are: " , str(sys.argv))\n    if len(sys.argv) != 2:\n        print("[ERROR] - The ConsumeAvroMessage.py script expects one arguments: The Kafka topic to events from.")\n        exit(1)\n    TOPIC_NAME = sys.argv[1]\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"The main where we will:"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},"Parse the arguments to get the topic to read from"),Object(r.b)("li",{parentName:"ol"},"Create the Kafka Consumer and configure it"),Object(r.b)("li",{parentName:"ol"},"Poll for next avro message"),Object(r.b)("li",{parentName:"ol"},"Close the Kafka consumer")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"if __name__ == '__main__':\n    # Parse arguments\n    parseArguments()\n    # Create the Kafka Avro consumer\n    kafka_consumer = KafkaConsumer(KAFKA_BROKERS,SCRAM_USERNAME,SCRAM_PASSWORD,TOPIC_NAME,SCHEMA_REGISTRY_URL)\n    # Prepare the consumer\n    kafka_consumer.prepareConsumer()\n    # Consume next Avro event\n    kafka_consumer.pollNextEvent()\n    # Close the Avro consumer\n    kafka_consumer.close()\n")))),Object(r.b)("p",null,"As you can see, this python code depends on a ",Object(r.b)("strong",{parentName:"p"},"Kafka Avro Consumer")," to consume messages. This is explained next."),Object(r.b)("h3",null,"Kafka Avro Consumer"),Object(r.b)("p",null,"This script, called ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab/kafka/KcAvroConsumer.py"}),"KcAvroConsumer.py"),", will actually be the responsible for creating the Kafka Avro Consumer, initialize and configure it and provide the poll next event method:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Initialize and prepare the new Kafka consumer:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"class KafkaConsumer:\n\n    def __init__(self, kafka_brokers = \"\", scram_username = \"\",scram_password = \"\", topic_name = \"\", schema_registry_url = \"\", autocommit = True):\n        self.kafka_brokers = kafka_brokers\n        self.scram_username = scram_username\n        self.scram_password = scram_password\n        self.topic_name = topic_name\n        self.schema_registry_url = schema_registry_url \n        self.kafka_auto_commit = autocommit\n\n    # See https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md\n    def prepareConsumer(self, groupID = \"pythonconsumers\"):\n        options ={\n            'bootstrap.servers':  self.kafka_brokers,\n            'group.id': groupID,\n            'auto.offset.reset': 'earliest',\n            'schema.registry.url': self.schema_registry_url,\n            'enable.auto.commit': self.kafka_auto_commit,\n            'security.protocol': 'SASL_SSL',\n            'sasl.mechanisms': 'SCRAM-SHA-512',\n            'sasl.username': self.scram_username,\n            'sasl.password': self.scram_password,\n            'ssl.ca.location': os.environ['PEM_CERT'],\n            'schema.registry.ssl.ca.location': os.environ['PEM_CERT']\n        }\n        # Print the configuration\n        print(\"--- This is the configuration for the Avro consumer: ---\")\n        print(options)\n        print(\"---------------------------------------------------\")\n        # Create the Avro consumer\n        self.consumer = AvroConsumer(options)\n        # Subscribe to the topic\n        self.consumer.subscribe([self.topic_name])\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Poll next event method:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# Prints out the message\ndef traceResponse(self, msg):\n    print(\'[Message] - Next message consumed from {} partition: [{}] at offset {} with key {} and value {}\'\n                .format(msg.topic(), msg.partition(), msg.offset(), msg.key(), msg.value() ))\n\n# Polls for next event\ndef pollNextEvent(self):\n    # Poll for messages\n    msg = self.consumer.poll(timeout=10.0)\n    # Validate the returned message\n    if msg is None:\n        print("[INFO] - No new messages on the topic")\n    elif msg.error():\n        if ("PARTITION_EOF" in msg.error()):\n            print("[INFO] - End of partition")\n        else:\n            print("[ERROR] - Consumer error: {}".format(msg.error()))\n    else:\n        # Print the message\n        msgStr = self.traceResponse(msg)\n')))),Object(r.b)("h2",null,"Schemas and Messages"),Object(r.b)("p",null,"In this section we are going to see how Schema Registry works when you have an application that produces and consumes messages based on Avro data schemas. The application we are going to use for this is the python application presented above in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#python-avro-producer"}),"Python Avro Producer")," and ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#python-avro-consumer"}),"Python Avro Consumer")," sections."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"IMPORTANT:")," Before start using our Python application we must set the ",Object(r.b)("strong",{parentName:"p"},"PYTHONPATH")," environment variable to point to where we have all the Python scripts that make up our application in order for Python to find these at execution time."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Set the PYTHONPATH variable to the location where you cloned the GitHub repository containing the Python application we are going to be working with")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"export PYTHONPATH=~/refarch-eda-tools/labs/es-cp4i-schema-lab-v10\n")),Object(r.b)("h3",null,"Produce a message"),Object(r.b)("p",null,"In order to produce a message, we execute the ",Object(r.b)("inlineCode",{parentName:"p"},"ProduceAvroMessage.py"),". This script, as you could see in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#python-avro-producer"}),"Python Avro Producer")," section, is sending the event with key ",Object(r.b)("inlineCode",{parentName:"p"},"{'key': '1'}")," and value ",Object(r.b)("inlineCode",{parentName:"p"},"{'message': 'This is a test message'}")," according to the schemas defined in ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"avro_files/default_key.avsc"}),"default_key.avsc")," and ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"avro_files/default_value.avsc"}),"default_value.avsc")," for the key and value of the event respectively."),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Make sure you are on the right path where the python scripts live: ",Object(r.b)("strong",{parentName:"p"},"~/refarch-eda-tools/labs/es-cp4i-schema-lab-v10/src"))),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Change user1")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"python3 ProduceAvroMessage.py test-schema-user1\n\n @@@ Executing script: ProduceAvroMessage.py\nThe arguments for the script are:  ['ProduceAvroMessage.py', 'test-schema-user1']\nCreating event...\nDONE\n--- Event to be published: ---\n{\"key\": 1}\n{\"message\": \"This is a test message\"}\n----------------------------------------\n--- This is the configuration for the avro producer: ---\n{'bootstrap.servers': 'es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443', 'schema.registry.url': 'https://my-user1:*****@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net', 'group.id': 'ProduceAvroMessagePython', 'security.protocol': 'SASL_SSL', 'sasl.mechanisms': 'SCRAM-SHA-512', 'sasl.username': 'my-user1', 'sasl.password': '*****', 'ssl.ca.location': '/home/ALMARAZJ/es-cert.pem', 'schema.registry.ssl.ca.location': '/home/ALMARAZJ/es-cert.pem'}\n---------------------------------------------------\nMessage delivered to test-schema-user1 [0]\n")),Object(r.b)("p",null,"We can see our new message delivered in the ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1")," topic by"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Go into the topics page in the IBM Event Streams UI"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"30.90277777777778%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAAyUlEQVQY062P0QqCMBSG94Y+jiLTO4PupLoIuukxepW6U7cSlNzmvBhO/pqJJHUTdOCDb2c7h3/E8zwkqxXCMEQURTP03emy/352xPGTyUmSrPHPIpRSKNEgyzJwxsAmiqKYPc/zhXPOcT5fsN2kSHcH+Mc79icF3UoQ91XddSjLEkKImaqqPlxKOXpd12gaMS5mjCO7SVyr9rmwBQmCYIyqtYYxBn3fw1q7YBiGr+7KvR+sge0NWrfQ9/3xwiVwDaXUT7xmXrhQD3xepyuVXKzEAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"14",title:"14",src:"/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/3cbba/14-v10.png",srcSet:["/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/7fc1e/14-v10.png 288w","/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/a5df1/14-v10.png 576w","/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/3cbba/14-v10.png 1152w","/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/0b124/14-v10.png 1728w","/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/4ea69/14-v10.png 2304w","/refarch-eda/static/2b35c38492beab751e7bc851dadf9f58/23ca2/14-v10.png 3058w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Click on the topic and then on the ",Object(r.b)("em",{parentName:"p"},"Messages")," tab at the top. Finally, click on a message to see it displayed on the right hand side of the screen"),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.79166666666667%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABMElEQVQoz6WQy0rEMBSG+4Ljk7gTL8mi07oYBBF0JbjRR/ABfAXdiAi6ULx0OszY6SVJp+nlNydjpSOFLgx8nPwn5M9/4oxGW5hMjsA5g+u6GI89+P4hPM/fwPeo7w/iHJ+cglZZVtCG/y5nd48hjmME0yk+wwWePhQeXiUe33LcvyjcPksECwVd5NBam4fLDbQuUeh1Je0wxiGlQhR9IUkSnF3PcXA1x/5liJ2Ld2yfB7i5i9GU8neCpmns5bquf3I1Fuo7nHPbIrNMCCzjCEKk5pHM9Ja2qnwFpZQ1aQ1JU+JWE3Zkxpjd0NhZZkzSzBgrCJmvUSujJWazcPD/bMK/hsKkpNqFenROifr/UaOqqv6ErUELaSml/ZI0Ta2mcbvQeVEU/YZds9aQantxiG91p5B6sd6mKwAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"15",title:"15",src:"/refarch-eda/static/7d07935eb7aa148c445849671f03048c/3cbba/15-v10.png",srcSet:["/refarch-eda/static/7d07935eb7aa148c445849671f03048c/7fc1e/15-v10.png 288w","/refarch-eda/static/7d07935eb7aa148c445849671f03048c/a5df1/15-v10.png 576w","/refarch-eda/static/7d07935eb7aa148c445849671f03048c/3cbba/15-v10.png 1152w","/refarch-eda/static/7d07935eb7aa148c445849671f03048c/0b124/15-v10.png 1728w","/refarch-eda/static/7d07935eb7aa148c445849671f03048c/4ea69/15-v10.png 2304w","/refarch-eda/static/7d07935eb7aa148c445849671f03048c/8a0da/15-v10.png 3098w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"INFO:")," Mind the message now is not in JSON format as Avro does not repeat every field name with every single record which makes Avro more efficient than JSON for high-volume usage. This is thanks to having Avro schemas.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"IMPORTANT:")," As you can see, we got the ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1")," topic auto-created when we produced the message. The reason for this is that"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Kafka is set out of the box to let applications to auto-create topics."),Object(r.b)("li",{parentName:"ol"},"We created the SCRAM credentials for our application to allow the application to create topics.")),Object(r.b)("p",null,"On a production-like environment, you don’t want developers creating applications that auto-create topics in your IBM Event Streams instance without any control. For that, we would configure Kafka to forbid topic auto-creation (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://kafka.apache.org/documentation/#auto.create.topics.enable"}),"https://kafka.apache.org/documentation/#auto.create.topics.enable"),") as well as thoroughly created the SCRAM credentials with the most strict but appropriate permissions that our application needs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"IMPORTANT:")," Similar to the auto-creation of topics, we can see below that our application got the Avro data schemas for both the key and value of the message produced auto-registered. This is because many client libraries come with a SerDes property to allow them to auto-register the Avro data schemas (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.confluent.io/current/clients/confluent-kafka-python/#avroserializer"}),"https://docs.confluent.io/current/clients/confluent-kafka-python/#avroserializer"),"). However, on a production-like environment we don’t want applications to auto-register schemas without any control but yet we can not leave it to the developers to set the auto-registration property off on their libraries. Instead, we would create the SCRAM credentials with the most strict but appropriate permissions that our application needs."),Object(r.b)("p",null,"If we look now at the schemas our schema registry has:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es schemas\n\nSchema                           State    Latest version   Latest version ID   Updated   \ndemoSchema_CLI_USER1             active   2.0.0            2                   Fri, 24 Jul 2020 14:09:37 UTC   \ndemoSchema_UI_USER1              active   2.0.0            2                   Fri, 24 Jul 2020 14:06:27 UTC   \ntest-schema-user1-key-d89uk      active   1                1                   Fri, 24 Jul 2020 15:41:46 UTC   \ntest-schema-user1-value-tv5efr   active   1                1                   Fri, 24 Jul 2020 15:41:45 UTC   \nOK\n")),Object(r.b)("p",null,"we see two schemas, ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1-key-d89uk")," and ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1-value-tv5efr"),", which in fact correspond to the Avro data schema used for the ",Object(r.b)("inlineCode",{parentName:"p"},"key")," (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"avro_files/default_key.avsc"}),"default_key.avsc"),") and the ",Object(r.b)("inlineCode",{parentName:"p"},"value")," (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"avro_files/default_value.avsc"}),"default_value.avsc"),") of events sent to the ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1")," topic in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/es-cloud-schema-lab-v10/src/ProduceAvroMessage.py"}),"ProduceAvroMessage.py")," as explained before sending the message."),Object(r.b)("p",null,"To make sure of what we are saying, we can inspect those schemas:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'cloudctl es schema test-schema-user1-key-d89uk --version 1\n\n{\n  "type": "record",\n  "name": "defaultKey",\n  "namespace": "ibm.eda.default",\n  "fields": [\n    {\n      "type": "int",\n      "name": "key",\n      "doc": "We expect any int as the event key"\n    }\n  ],\n  "doc": "Default Message\'s key Avro data schema"\n}\n')),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'cloudctl es schema test-schema-user1-value-tv5efr --version 1\n\n{\n  "type": "record",\n  "name": "defaultValue",\n  "namespace": "ibm.eda.default",\n  "fields": [\n    {\n      "type": "string",\n      "name": "message",\n      "doc": "Any string"\n    }\n  ],\n  "doc": "Default Message\'s value Avro data schema"\n}\n')),Object(r.b)("p",null,"If I now decided that my events should contain another attribute, I would modify the event value schema (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"avro_files/default_value.avsc"}),"default_value.avsc"),") to reflect that as well as ",Object(r.b)("inlineCode",{parentName:"p"},"ProduceAvroMessage.py")," to send that new attribute in the event it sends:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Change user1")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"python3 ProduceAvroMessage.py test-schema-user1\n\n @@@ Executing script: ProduceAvroMessage.py\nThe arguments for the script are:  ['ProduceAvroMessage.py', 'test-schema-user1']\nCreating event...\nDONE\n--- Event to be published: ---\n{\"key\": 1}\n{\"message\": \"This is a test message\", \"anotherAttribute\": \"Just another test string\"}\n----------------------------------------\n--- This is the configuration for the avro producer: ---\n{'bootstrap.servers': 'es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443', 'schema.registry.url': 'https://my-user1:*****@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net', 'group.id': 'ProduceAvroMessagePython', 'security.protocol': 'SASL_SSL', 'sasl.mechanisms': 'SCRAM-SHA-512', 'sasl.username': 'my-user1', 'sasl.password': '*****', 'ssl.ca.location': '/home/ALMARAZJ/es-cert.pem', 'schema.registry.ssl.ca.location': '/home/ALMARAZJ/es-cert.pem'}\n---------------------------------------------------\nMessage delivered to test-schema-user1 [0]\n")),Object(r.b)("p",null,"I can see that an event with a new attribute has been sent:"),Object(r.b)("p",null," ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.09722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPklEQVQoz6WQu07DQBBF/Xv5GAqM7dhGAlEgGloapBT8Aw0fAwUReXmXeP3a+JFc9q5jsJQiBSsd7WgSn507zmQywc3tHVzXRRAECMMQcXyNKIoRRpElOkMc97B27h8ewVPXNcpS47/H8fwQRVEgSQRWm28shMZ8XeEr0fjc1HhfaCxFhaZp0LYtuq47oWkNTWd+7+C4Vx6UyowwQZGnmL1JuDOJ8EXi0twXz1s8vUrsdIXaSHkOhwP2+72FtelYWDvTaWD/pJSyk66FwjJJDQof8xXmK4nNtjTrKKH130o4cVVVR2H/iBV6nmcbaZpaIeE++ToFhLGEELZ/doe+7x+F/YRZliHP815upuLN6aQ0sXc7Kx92OcQex/8VMvKvyMB6gELCx8awx9iENaUnwrF0EPNmdH44rGEQjWH/B6A9jo7zb7zrAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"16",title:"16",src:"/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/3cbba/16-v10.png",srcSet:["/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/7fc1e/16-v10.png 288w","/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/a5df1/16-v10.png 576w","/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/3cbba/16-v10.png 1152w","/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/0b124/16-v10.png 1728w","/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/4ea69/16-v10.png 2304w","/refarch-eda/static/00902c84ce9ad46c78a4b4aa688e1dc1/29002/16-v10.png 3050w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("p",null,"And I can also see that the new shcema has got registered as well:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"cloudctl es schemas\n\nSchema                           State    Latest version   Latest version ID   Updated   \ndemoSchema_CLI_USER1             active   2.0.0            2                   Fri, 24 Jul 2020 14:09:37 UTC   \ndemoSchema_UI_USER1              active   2.0.0            2                   Fri, 24 Jul 2020 14:06:27 UTC   \ntest-schema-user1-key-d89uk      active   1                1                   Fri, 24 Jul 2020 15:41:46 UTC   \ntest-schema-user1-value-a5bbaa   active   1                1                   Fri, 24 Jul 2020 15:54:37 UTC   \ntest-schema-user1-value-tv5efr   active   1                1                   Fri, 24 Jul 2020 15:41:45 UTC   \nOK\n")),Object(r.b)("p",null,"If I inspect that new schema, I see my new attribute in it:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'cloudctl es schema test-schema-user1-value-a5bbaa --version 1\n\n{\n  "type": "record",\n  "name": "defaultValue",\n  "namespace": "ibm.eda.default",\n  "fields": [\n    {\n      "type": "string",\n      "name": "message",\n      "doc": "Any string"\n    },\n    {\n      "type": "string",\n      "name": "anotherAttribute",\n      "doc": "Any other string"\n    }\n  ],\n  "doc": "Default Message\'s value Avro data schema"\n}\n')),Object(r.b)(p,{kind:"info",mdxType:"InlineNotification"},Object(r.b)("p",null,"The schema evolution above (test-schema-user1-value-a5bbaa) should have got registered as a new version of the already existing schema (test-schema-user1-value-tv5efr). IBM Event Streams allows schemas to auto-register themselves when these are sent along with a message from a producer application. However, the Schema Registry does not pick “new” schemas up as a new version of a previous schema and simply creates a new schema. Anyway, when reading messages off the topic, Schema Registry handles well what schema to return back to the receiver application so messages can get properly deserialized. Will see that in the next section. ")),Object(r.b)(p,{kind:"error",mdxType:"InlineNotification"},Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"SECURITY:")," As some of you may have already thought, having your clients (that is your applications), auto-register the Avro data schemas that are in the end kind of the contracts that your components of your overal solution agree on in order to understand each other and collaborate between them is ",Object(r.b)("strong",{parentName:"p"},"NOT")," a good idea. Specially in microservices architectures where you might have hundreds of microservices talking and collaborating among themselsves. We will see in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#security"}),"Security")," section how we can control schema registration and evolution based on roles at the schema level also.")),Object(r.b)("h3",null,"Create a non-compliant message"),Object(r.b)("p",null,"Let’s see what happens if we send a message that does not comply with its Avro data schema. Let’s say that I send the following message:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'key = {"key": 1}\nvalue = {"message" : 12345}\n')),Object(r.b)("p",null,"and this is the output of that attempt:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Change user1")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'python3 ProduceAvroMessage.py test-schema-user1\n\n @@@ Executing script: ProduceAvroMessage.py\nThe arguments for the script are:  [\'ProduceAvroMessage.py\', \'test-schema-user1\']\nCreating event...\nDONE\n--- Event to be published: ---\n{"key": 1}\n{"message": 12345}\n----------------------------------------\n--- This is the configuration for the avro producer: ---\n{\'bootstrap.servers\': \'es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443\', \'schema.registry.url\': \'https://my-user1:*****@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net\', \'group.id\': \'ProduceAvroMessagePython\', \'security.protocol\': \'SASL_SSL\', \'sasl.mechanisms\': \'SCRAM-SHA-512\', \'sasl.username\': \'my-user1\', \'sasl.password\': \'*****\', \'ssl.ca.location\': \'/home/ALMARAZJ/es-cert.pem\', \'schema.registry.ssl.ca.location\': \'/home/ALMARAZJ/es-cert.pem\'}\n---------------------------------------------------\nTraceback (most recent call last):\n  File "ProduceAvroMessage.py", line 81, in <module>\n    kafka_producer.publishEvent(TOPIC_NAME,event_value,event_key)\n  File "/tmp/lab/kafka/KcAvroProducer.py", line 43, in publishEvent\n    self.producer.produce(topic=topicName,value=json.loads(value),key=json.loads(key), callback=self.delivery_report)\n  File "/root/.local/lib/python3.7/site-packages/confluent_kafka/avro/__init__.py", line 99, in produce\n    value = self._serializer.encode_record_with_schema(topic, value_schema, value)\n  File "/root/.local/lib/python3.7/site-packages/confluent_kafka/avro/serializer/message_serializer.py", line 118, in encode_record_with_schema\n    return self.encode_record_with_schema_id(schema_id, record, is_key=is_key)\n  File "/root/.local/lib/python3.7/site-packages/confluent_kafka/avro/serializer/message_serializer.py", line 152, in encode_record_with_schema_id\n    writer(record, outf)\n  File "/root/.local/lib/python3.7/site-packages/confluent_kafka/avro/serializer/message_serializer.py", line 86, in <lambda>\n    return lambda record, fp: writer.write(record, avro.io.BinaryEncoder(fp))\n  File "/root/.local/lib/python3.7/site-packages/avro/io.py", line 771, in write\n    raise AvroTypeException(self.writer_schema, datum)\navro.io.AvroTypeException: The datum {\'message\': 12345} is not an example of the schema {\n  "type": "record",\n  "name": "defaultValue",\n  "namespace": "ibm.eda.default",\n  "fields": [\n    {\n      "type": "string",\n      "name": "message",\n      "doc": "Any string"\n    },\n    {\n      "type": "string",\n      "name": "anotherAttribute",\n      "doc": "Any other string"\n    }\n  ],\n  "doc": "Default Message\'s value Avro data schema"\n}\n')),Object(r.b)("p",null,"As we can see, the attempt failed as the Avro producer will check the message against the Avro data schema defined for the topic we want to send the message to and yield that this message does not comply (the message value attribute we are sending is an integer rather than a string and we are missing the second attribute)."),Object(r.b)("p",null,"Therefore, using Avro schemas with IBM Event Streams give us the ability to build our system with ",Object(r.b)("strong",{parentName:"p"},"robustness")," protecting downstream data consumers from malformed data, as only valid data will be permitted in the topic."),Object(r.b)("h3",null,"Consume a message"),Object(r.b)("p",null,"In order to consume a message, we execute the ",Object(r.b)("inlineCode",{parentName:"p"},"ConsumeAvroMessage.py")," within the ",Object(r.b)("inlineCode",{parentName:"p"},"/tmp/lab/src")," folder in our python demo environment:"),Object(r.b)(p,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("p",null,"Change user1")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"python3 ConsumeAvroMessage.py test-schema-user1\n\n @@@ Executing script: ConsumeAvroMessage.py\nThe arguments for this script are:  ['ConsumeAvroMessage.py', 'test-schema-user1']\n--- This is the configuration for the Avro consumer: ---\n{'bootstrap.servers': 'es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443', 'group.id': 'pythonconsumers', 'auto.offset.reset': 'earliest', 'schema.registry.url': 'https://my-user1:*****@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net', 'enable.auto.commit': True, 'security.protocol': 'SASL_SSL', 'sasl.mechanisms': 'SCRAM-SHA-512', 'sasl.username': 'my-user1', 'sasl.password': '*****', 'ssl.ca.location': '/home/ALMARAZJ/es-cert.pem', 'schema.registry.ssl.ca.location': '/home/ALMARAZJ/es-cert.pem'}\n---------------------------------------------------\n[Message] - Next message consumed from test-schema-user1 partition: [0] at offset 0 with key {'key': 1} and value {'message': 'This is a test message'}\n\n\npython3 ConsumeAvroMessage.py test-schema-user1\n\n @@@ Executing script: ConsumeAvroMessage.py\nThe arguments for this script are:  ['ConsumeAvroMessage.py', 'test-schema-user1']\n--- This is the configuration for the Avro consumer: ---\n{'bootstrap.servers': 'es-1-kafka-bootstrap-integration.apps.eda-solutions.gse-ocp.net:443', 'group.id': 'pythonconsumers', 'auto.offset.reset': 'earliest', 'schema.registry.url': 'https://my-user1:*****@es-1-ibm-es-schema-external-integration.apps.eda-solutions.gse-ocp.net', 'enable.auto.commit': True, 'security.protocol': 'SASL_SSL', 'sasl.mechanisms': 'SCRAM-SHA-512', 'sasl.username': 'my-user1', 'sasl.password': '*****', 'ssl.ca.location': '/home/ALMARAZJ/es-cert.pem', 'schema.registry.ssl.ca.location': '/home/ALMARAZJ/es-cert.pem'}\n---------------------------------------------------\n[Message] - Next message consumed from test-schema-user1 partition: [0] at offset 1 with key {'key': 1} and value {'message': 'This is a test message', 'anotherAttribute': 'Just another test string'}\n")),Object(r.b)("p",null,"As you can see, our script was able to read the Avro messages from the ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-user1")," topic and map that back to their original structure thanks to the Avro schemas:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"[Message] - Next message consumed from test-schema partition: [0] at offset 0 with key {'key': 1} and value {'message': 'This is a test message'}\n\n[Message] - Next message consumed from test-schema partition: [0] at offset 1 with key {'key': 1} and value {'message': 'This is a test message', 'anotherAttribute': 'Just another test string'}\n")),Object(r.b)("h2",null,"Data Evolution"),Object(r.b)("p",null,"So far we have more or less seen what Avro is, what an Avro data schema is, what a schema registry is and how this all works together. From creating an Avro data schema for your messages/events to comply with to how the schema registry and Avro data schemas work together. And we have also seen the code for doing all this, from the python code to send and receive Avro encoded messages based on their Avro data schemas to the rich CLI IBM Event Streams provides to interact with."),Object(r.b)("p",null,"However, we have said little about the need for data to evolve. When you design an Event Driven architecture for your application (by applying ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"../../methodology/event-storming/"}),"Event Storming")," or ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"../../methodology/domain-driven-design/"}),"Domain Driven Design")," for example), it is very hard to come up with data structures/schemas that will not need to evolve/change in time. That is, your data, like your use or business cases, may need to evolve. As a result, Avro data schemas must be somehow flexible to allow your data to evolve along with your application and use cases."),Object(r.b)("p",null,"But it is not as easy as adding or removing data that travels in your events/messages or modifying the type of such data. And one of the reasons for this is that Kafka (or any other type of event backbone) is many times used as the source of truth. That is, a place that you can trust as to what has happened. Hence, Kafka will serve as the source of truth where all the events (that is, data) that happened (which could be bank transactions, communications, etc) will get stored (sometimes up to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.confluent.io/blog/publishing-apache-kafka-new-york-times/"}),"hundreds of years"),") and will be able to be replayed if needed. As a result, there must be a data schema management and data schema evolution put in place that allow the ",Object(r.b)("strong",{parentName:"p"},"compatibility")," of old and new data schemas and, in fact, old and new data at the end of the day."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"The IBM Event Streams Schema Registry enforces full compatibility when creating a new version of a schema"),". Full compatibility means that ",Object(r.b)("strong",{parentName:"p"},"old data can be read with the new data schema, and new data can also be read with the last data schema"),"."),Object(r.b)("p",null,"In data formats like Avro, you can define fields with default values. In that case adding or removing a field with a default value is a fully compatible change. Let’s see then how this affects when you want your data to evolve in a way that it needs to add a new attribute or delete an existing attribute."),Object(r.b)("p",null,"But let’s see what that means in terms of adding and removing attributes from your data schema."),Object(r.b)("h3",null,"Adding a new attribute"),Object(r.b)("p",null,"Although we have already seen this in the adding a new version of a schema section, let’s try to add a new version of our ",Object(r.b)("inlineCode",{parentName:"p"},"test-schema-value")," schema where we have a new attribute. Remember, our ",Object(r.b)("inlineCode",{parentName:"p"},"default_schema.avsc")," already contains a new attribute than the original one but that it got registered as a new schema rather than as a new version of the original one. Let’s reuse that Avro schema file to register it as a new version (",Object(r.b)("strong",{parentName:"p"},"INFO:")," you might need to copy/download that file to your local workstation in order to be able to then upload it to the IBM Event Streams through its UI)"),Object(r.b)("p",null,"When doing so from the UI, we see the following error:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.041666666666664%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABcElEQVQoz42QS0/CUBCF+5uxgNZocM/CnTsWJv4EWBh37o0LEEMCfdCm0Ef6uH3QmHCcuVCtxQVNTia999wz34yiXd/i8uoGnU4HvV4PqqrigqSeIfYPBnfQNA39fh/dbhdKWe4QJymEEMjzHGd9+70sWZZhPB5jsVggiiJUVQXFdV1Ypg7XMeE4DkzLwkrXEcWxfJBSoxOlBEB3m80Gk8kE0+kUtm0jCAIoq3WI1zcbs2WIhEKeRiPcD4ewDQNVliMJQ8RkrBX5PmI/QJYkcqI90TJZURQSQHl5L6A+Vnh43h1Mhon1/BPG7AMmyZrPZWVtl0v4RB/oBkoakSlTesPrqqWURYaqFPiqcnmw9TzEx3FZvBsekWlYJZHkeUFevhey8rvarwi5l+xnNyGN2OyYEEHSokhS9h5C6rNG4G8HDvSIUC6djXTG/6xmoPQL0aBsBNZd6uo1RhYczLtqhTWpTgjbgX8MR5La3Jb45+4buCDZwmD/0gMAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"17",title:"17",src:"/refarch-eda/static/c988aedcb63fa9b918717531689d510a/3cbba/17-v10.png",srcSet:["/refarch-eda/static/c988aedcb63fa9b918717531689d510a/7fc1e/17-v10.png 288w","/refarch-eda/static/c988aedcb63fa9b918717531689d510a/a5df1/17-v10.png 576w","/refarch-eda/static/c988aedcb63fa9b918717531689d510a/3cbba/17-v10.png 1152w","/refarch-eda/static/c988aedcb63fa9b918717531689d510a/0b124/17-v10.png 1728w","/refarch-eda/static/c988aedcb63fa9b918717531689d510a/4ea69/17-v10.png 2304w","/refarch-eda/static/c988aedcb63fa9b918717531689d510a/ee212/17-v10.png 2876w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("p",null,"The reason, as alread explained in the add a new version of a schema section, is because full compatibility dictates that you can only add new attributes to a schema if these have a default value. Reason being that a receiver should be able to deserialize messages produced with an older schema using the newer schema. Because old messages were written with an older schema that did not contain our new attribute, those messages won’t have that attribute so we need to provide a default value for it in our never version of the schema so that the receiver is able to deserialize those older messages with the newer schema."),Object(r.b)("p",null,"If we add the default value for the new attribute, we see that our newer version is now compatible:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.48611111111111%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRUlEQVQoz5VQXUsCQRTdf+0uVuJGEb36AxJ66y3qIeghgiSQFCkVEoJINLX9mL0z7jqrcZqZRWm3D2rgcOfee+65h2vtVFxsbVdRKpVQLpdh27aB4zi/QnOqVRf7ey4OXBu7FT3nwJJyCeIx4jiBlBL/ee1WEyfnDRw1gOvHrGZNXscYvTxhMnrGcDhEt9tFr9cDYwxEhCiKzL8IIo6H+w6ubtq4aM3RGhA4MVidgY/jyzFu+wxB4KNWq6Fer0MIgSRJVC0A5zwHIbIoZYr3VQqkHMtFVrMa/RiHpwuc3UnMFTFNU2NdN9cOi4Is0lEokOEQCXU2YRZZKyn0OLCaq2HCbDbLiXieBxYy43hdo41TsYlrWPoWemOkt6ht0+k0R37zPQQs/OLyR8HPiW76vp8jh+rQIWWCgou/CxYbxdzUivk3nA+ry5B7rVG3BgAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"18",title:"18",src:"/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/3cbba/18-v10.png",srcSet:["/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/7fc1e/18-v10.png 288w","/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/a5df1/18-v10.png 576w","/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/3cbba/18-v10.png 1152w","/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/0b124/18-v10.png 1728w","/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/4ea69/18-v10.png 2304w","/refarch-eda/static/4f199a1c0c71eb490ddbec51de800a00/497fa/18-v10.png 2980w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("p",null,"and that it gets registered fine:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"50%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZElEQVQoz52Sy0rDQBiF83Z9FotSUmqgEnHtwkB9CgtuLO2ub6AIdtFVLUYSDJHcL22ux56hqbYIXn74SPhn/nNOZiK1Wi2cqRc4ah+j0+lAlmVBt9uFoii/onf6iaSqKlhlVQN1jaaqqsJ/SlL6Km6Gt7jSrjEYDKBpGkajkRBcr9fIsgxFUSDP8x3slVvDOAMu73KcD3No4wxST+nDsizM53Msl0ssFs8wTHMTtkYURUKM4vU2ffO0bRuTyRj3D4/Q7QIvdgnTrSC1T2S82T5eDQvvTiBwvGgnGAQBwjBEmqYiGaEBQ0ynU8xmTyizBHW54kFB4gXQ0/cDIcDhOI5FCg7pui7SeJ4naPbQgKZ5XiDc9NLVShhJvE0Wk8RxJAaSJBGbfd+Hufl813WFAI0aGmHCd543Z/YEuUA4wEUmMgxDiDqOs7fnkNV3CZvFJiGfX1MR9g5hP8t+SFiW5Z/hH/EBeNbRp49fivsAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"19",title:"19",src:"/refarch-eda/static/066e9d9cae796ce7af172e3479659961/3cbba/19-v10.png",srcSet:["/refarch-eda/static/066e9d9cae796ce7af172e3479659961/7fc1e/19-v10.png 288w","/refarch-eda/static/066e9d9cae796ce7af172e3479659961/a5df1/19-v10.png 576w","/refarch-eda/static/066e9d9cae796ce7af172e3479659961/3cbba/19-v10.png 1152w","/refarch-eda/static/066e9d9cae796ce7af172e3479659961/0b124/19-v10.png 1728w","/refarch-eda/static/066e9d9cae796ce7af172e3479659961/4ea69/19-v10.png 2304w","/refarch-eda/static/066e9d9cae796ce7af172e3479659961/64269/19-v10.png 2908w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h3",null,"Removing an existing attribute"),Object(r.b)("p",null,"What if we now wanted to remove the original ",Object(r.b)("inlineCode",{parentName:"p"},"message")," attribute from our schema. Let’s remove it from the ",Object(r.b)("inlineCode",{parentName:"p"},"default_value.avsc")," file and try to register that new version:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"48.958333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABd0lEQVQoz5VS7WrCQBDMAxfED4zQKoU+R9+ggvRfnkFoLVgrGKskxhg1ibm7RFuQ6e6ZVNtKaQOT3c3tzM3exTAbl6g3rlAqlVCtVlGpVFAulzU4/w3cY5omWq0W6vU6arUajLe3dwihoFSKNE3x38dxHFiWBd/3SUfAmM992ONXuM4ErutiEQTwPA9hGEJIiSRJvoJIjM1mQyYU+v0+Op0OhsOhFjdm/hq9lxlG00A7vG+3cd1s4qHbBfZ7KBIRRJYEETNiJFGsv0vacLfbaaccsyyDYT2muLjd4uZuhzhOkE6mGPeeYBOmtLvzPIAzGOg8sMdY0/piZEPMPGxJsJiCxRmGkApxoiBUpkeIaFSGzJ3FlIerla4VjXoE1SxCHI7MZRj8ylKFlKJUEisi8xkVDSI/L5mTCycbcciVOkYtWDRIeVjQl0EiuomJ5Gy5XOqx1IlggR+Cp02cMzmKos/GhC4hpvq70J8FWaz4JfSIeX7O3TnBD9fj2EIwg4E7AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"20",title:"20",src:"/refarch-eda/static/bab59066233a0172302e29c11a165517/3cbba/20-v10.png",srcSet:["/refarch-eda/static/bab59066233a0172302e29c11a165517/7fc1e/20-v10.png 288w","/refarch-eda/static/bab59066233a0172302e29c11a165517/a5df1/20-v10.png 576w","/refarch-eda/static/bab59066233a0172302e29c11a165517/3cbba/20-v10.png 1152w","/refarch-eda/static/bab59066233a0172302e29c11a165517/0b124/20-v10.png 1728w","/refarch-eda/static/bab59066233a0172302e29c11a165517/4ea69/20-v10.png 2304w","/refarch-eda/static/bab59066233a0172302e29c11a165517/eb85e/20-v10.png 2808w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("p",null,"We, again, get the same error. And the reason is because receivers must be able to read and deserialize messages produced with the newer schema (that is, without the ",Object(r.b)("inlineCode",{parentName:"p"},"message")," attribute) but with the older schema (that is, with the schema version that enforces the existence of the ",Object(r.b)("inlineCode",{parentName:"p"},"message")," attribute)."),Object(r.b)("p",null,"In order to work this around, what we need to do is to register first an intermediate schema that defines a default value for the ",Object(r.b)("inlineCode",{parentName:"p"},"message")," attribute:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.041666666666664%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbUlEQVQoz52STU7CUBSF3+5Yi0RDSqQGU+MGpElXYUicEBKdsAI1YcQMNJXStBUs/aN/rz1yX61Ww4B4kzN4f+d8vbes1WrhUrnGSfsUnU4HkiQJdbtdyLJ8lM57P2KKooCKFyWaVRQF/lPson+F2+EdBqoGTdOgqipGoxE450iSBGmaIs9zZFn2LdrjvApMOHAzzqAMMwzGKVhP7sOyLMxmMywWL5jP5zAMA2VZIggCYUC0tG7Wer3Gw8M9Hp+eoTsZXm0OY1OAtc8kmPYH3gwL7xtPaOP6wiAMQ3ieB9/3sdvtBBmJAhzHwWQywXQ6RZ5GKPOYGgVGA8j2n7TdbuHviehxEISCwrZt6LouHruuK0TUJAqgUGpHtY5FEKNpUhFJGFaXiYwuU8hyuRSGtB9FkTgjBV/hFUCAOI7FG0FYG9bpTcPVagXTNH/RNVWbk6EgPGRIJPVQyLQW0dSETR1FSGn06/wV9eyQ6vNPLCLRN80RBEQAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"21",title:"21",src:"/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/3cbba/21-v10.png",srcSet:["/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/7fc1e/21-v10.png 288w","/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/a5df1/21-v10.png 576w","/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/3cbba/21-v10.png 1152w","/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/0b124/21-v10.png 1728w","/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/4ea69/21-v10.png 2304w","/refarch-eda/static/3aaf9324cb24f07a741cd4e316669489/6b2f1/21-v10.png 2900w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("p",null,"Once we have a default value for the ",Object(r.b)("inlineCode",{parentName:"p"},"message")," attribute, we can register a new version of the schema that finally removes that attribute:"),Object(r.b)("p",null,"  ",Object(r.b)("span",Object(n.a)({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.833333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABX0lEQVQoz52R207CQBCG+3y8ioRECFBRjD6AmPQl1OiFxhtueALvjCHe2BZppLUUej5sD787C0W9MFEn+bOZzMy3u/9IjUYDh8NTNJsttNv76HQ6Qt1uF7Is/0q9/kZ9Lmk4PAIFywuURYE6qrLEf0KSB8e4vLrB2bkCRVEwGo0wHo9RVRXSNAVjDHmei7NWlmW8vgHMV8DJNcPBBcP9QwKp1x/ANE1Mp1Nomg5VVUVOQN/3BazgL6+2hPpUVQ13d7d4fHrGq51jvixhuxmkvVYbpu3CeLNgOx7ely5WbiAGgyAQUFIcx+JlpJLbMZvNMJlMoKkvKPOE38RQFQwSLSDlTa7rbgEBoigSwMViAV3XYVmWqH/2+EiSZGeLx/Ms29ghgBSe5yHkzTRQAx3HgWEYArxerwUoDMMdlGbqH9T+fgMGO2AsgAQmEYRU519FVlCtXtwPwEg0/EW0OPr+B5UUhqeZwGqYAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"22",title:"22",src:"/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/3cbba/22-v10.png",srcSet:["/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/7fc1e/22-v10.png 288w","/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/a5df1/22-v10.png 576w","/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/3cbba/22-v10.png 1152w","/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/0b124/22-v10.png 1728w","/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/4ea69/22-v10.png 2304w","/refarch-eda/static/f726e4b422e57750d08f11bc0d596e53/ea5c0/22-v10.png 2938w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(r.b)("h2",null,"Security"),Object(r.b)("p",null,"As we have already mentioned during the this tutorial, we need to pay attention to the permissions we give to users, groups, applications (and thefore the clients they used to interact with IBM Event Streams), etc since we don’t want everyone and everything to be, for instance, creating or deleting topics, schemas, etc."),Object(r.b)("p",null,"You can secure your IBM Event Streams resources in a fine-grained manner by managing the access each user and application has to each resource. Within IBM Event Streams, you can secure access to the following resource types, where the names in parentheses are the resource type names used in Access Control List (ACL) rules:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Topics (topic): you can control the ability of users and applications to create, delete, read, and write to a topic."),Object(r.b)("li",{parentName:"ul"},"Consumer groups (group): you can control an application’s ability to join a consumer group."),Object(r.b)("li",{parentName:"ul"},"Transactional IDs (transactionalId): you can control the ability to use the transaction capability in Kafka.")),Object(r.b)("p",null,"Note: Schemas in the Event Streams Schema Registry are a special case and are secured using the resource type of topic combined with a prefix of _",Object(r.b)("em",{parentName:"p"},"schema"),". You can control the ability of users and applications to create, delete, read, and update schemas."),Object(r.b)("p",null,"You can find more information about how to secure your IBM Event Streams resources in the official documentation at: ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://ibm.github.io/event-streams/security/managing-access/"}),"https://ibm.github.io/event-streams/security/managing-access/")))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=69b64448-daa194d60c5d2705798e.js.map