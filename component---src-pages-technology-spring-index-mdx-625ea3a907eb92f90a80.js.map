{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/LastModifiedDate.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/last-modified-date.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss","webpack:///./src/pages/technology/spring/index.mdx"],"names":["PageHeader","title","theme","tabs","className","cx","styles","pageHeader","withTabs","length","darkMode","id","text","EditLink","relativePagePath","repositoryProp","repository","useStaticQuery","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","strict","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","aria-label","list","React","Component","LastModifiedDate","date","lastModified","Date","toLocaleDateString","day","year","month","Default","pageContext","children","location","Title","frontmatter","titleType","frontmatterTheme","description","keywords","interiorTheme","useMetadata","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","Utils","module","exports","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-technology-spring-index-mdx-625ea3a907eb92f90a80.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport styles from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, theme, tabs = [] }) => (\n  <div\n    className={cx(styles.pageHeader, {\n      [styles.withTabs]: tabs.length,\n      [styles.darkMode]: theme === 'dark',\n    })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={styles.text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  render() {\n    const { title, tabs, slug } = this.props;\n    const currentTab = slug.split('/').filter(Boolean).slice(-1)[0];\n\n    const pageTabs = tabs.map((tab) => {\n      const slugifiedTab = slugify(tab, { lower: true, strict: true });\n      const selected = slugifiedTab === currentTab;\n      // matches with or without trailing slash: /?\n      // matches with or without hash link: (#.*)?\n      const currentTabRegex = new RegExp(`${currentTab}/?(#.*)?$`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav aria-label={title}>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPageTabs.propTypes = {\n  tabs: PropTypes.array,\n  slug: PropTypes.string,\n};\n","import LastModifiedDate from './LastModifiedDate';\n\nexport default LastModifiedDate;\n","import React from 'react';\nimport { Row, Column } from '../Grid';\nimport styles from './last-modified-date.module.scss';\n\nconst LastModifiedDate = ({ date }) => {\n  const options = {\n    day: '2-digit',\n    year: 'numeric',\n    month: 'long',\n  };\n\n  const lastModified = new Date(date);\n\n  return date ? (\n    <Row className={styles.row}>\n      <Column>\n        <div className={styles.text}>\n          Page last updated: {lastModified.toLocaleDateString('en-GB', options)}\n          {/* // https://www-03preprod.ibm.com/support/knowledgecenter/ibm_style/dates-and-times.html */}\n        </div>\n      </Column>\n    </Row>\n  ) : null;\n};\nexport default LastModifiedDate;\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport Utils from '../components/Utils';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\nimport useMetadata from '../util/hooks/useMetadata';\nimport LastModifiedDate from '../components/LastModifiedDate';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const {\n    tabs,\n    title,\n    theme: frontmatterTheme,\n    description,\n    keywords,\n    date,\n  } = frontmatter;\n\n  const { interiorTheme } = useMetadata();\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug.split('/').filter(Boolean).slice(-1)[0] ||\n      slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n\n  const theme = frontmatterTheme || interiorTheme;\n\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}>\n      <PageHeader\n        title={Title ? <Title /> : title}\n        label=\"label\"\n        tabs={tabs}\n        theme={theme}\n      />\n      {tabs && (\n        <PageTabs\n          title={title}\n          slug={slug}\n          tabs={tabs}\n          currentTab={currentTab}\n        />\n      )}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n        <LastModifiedDate date={date} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <Utils />\n    </Layout>\n  );\n};\n\nexport default Default;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"EditLink-module--bx--text-truncate--end--2pqje\",\"bxTextTruncateFront\":\"EditLink-module--bx--text-truncate--front--3_lIE\",\"link\":\"EditLink-module--link--1qzW3\",\"row\":\"EditLink-module--row--1B9Gk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageTabs-module--bx--text-truncate--end--267NA\",\"bxTextTruncateFront\":\"PageTabs-module--bx--text-truncate--front--3xEQF\",\"tabsContainer\":\"PageTabs-module--tabs-container--8N4k0\",\"list\":\"PageTabs-module--list--3eFQc\",\"listItem\":\"PageTabs-module--list-item--nUmtD\",\"link\":\"PageTabs-module--link--1mDJ1\",\"selectedItem\":\"PageTabs-module--selected-item--YPVr3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"last-modified-date-module--bx--text-truncate--end--123zi\",\"bxTextTruncateFront\":\"last-modified-date-module--bx--text-truncate--front--3xeKz\",\"text\":\"last-modified-date-module--text--24m-4\",\"row\":\"last-modified-date-module--row--2BquN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageHeader-module--bx--text-truncate--end--mZWeX\",\"bxTextTruncateFront\":\"PageHeader-module--bx--text-truncate--front--3zvrI\",\"pageHeader\":\"PageHeader-module--page-header--3hIan\",\"darkMode\":\"PageHeader-module--dark-mode--hBrwL\",\"withTabs\":\"PageHeader-module--with-tabs--3nKxA\",\"text\":\"PageHeader-module--text--o9LFq\"};","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/refarch-eda/refarch-eda/docs/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <p><strong parentName=\"p\">{`Audience`}</strong>{`: Developers`}</p>\n    <h2>{`Spring Cloud`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://spring.io/projects/spring-cloud\"\n      }}>{`Spring Cloud`}</a>{` is based on Spring boot programming model but focusing on cloud native deployment and distributed computing. As other spring boot app it includes jetty or tomcat, health checks, metrics… It supports the following patterns:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Distributed/versioned `}<a parentName=\"li\" {...{\n          \"href\": \"https://spring.io/projects/spring-cloud-config\"\n        }}>{`configuration`}</a>{`: externalize config in distributed system with config server.`}</li>\n      <li parentName=\"ul\">{`Service registration and discovery: uses Netflix Eureka, Apache Zookeeper or Consul to keep service information. `}</li>\n      <li parentName=\"ul\">{`Routing: supports HTTP (Open Feign or  Netflix Ribbon for load balancing) and messaging (RabbitMQ and Kafka)`}</li>\n      <li parentName=\"ul\">{`Service-to-service calls: Sptring Cloud Gateway and Netflix Zuul is used`}</li>\n      <li parentName=\"ul\">{`Load balancing`}</li>\n      <li parentName=\"ul\">{`Circuit Breakers: based on Netflix Hystrix: if the request fails for n time, the circuit open.   `}</li>\n      <li parentName=\"ul\">{`Global locks`}</li>\n      <li parentName=\"ul\">{`Leadership election and cluster state`}</li>\n      <li parentName=\"ul\">{`Distributed messaging`}</li>\n    </ul>\n    <p>{`It also supports pipelines for ci/cd and contract testing for interface validation. `}</p>\n    <h3>{`Getting started`}</h3>\n    <p>{`Use `}<a parentName=\"p\" {...{\n        \"href\": \"https://start.spring.io/\"\n      }}>{`start.spring.io`}</a>{` to create the application starting code using Kafka, Actuator, Cloud Stream or add the Spring Cloud BOM to your maven `}<inlineCode parentName=\"p\">{`pom.xml`}</inlineCode>{` file. See `}<a parentName=\"p\" {...{\n        \"href\": \"https://spring.io/projects/spring-cloud\"\n      }}>{`the Adding Spring Cloud To An Existing Spring Boot Application section.`}</a></p>\n    <p>{`As most of the microservices expose REST resource, we may need to add the starter web:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n`}</code></pre>\n    <p>{`We also need to install the `}<a parentName=\"p\" {...{\n        \"href\": \"https://cloud.spring.io/spring-cloud-cli/\"\n      }}>{`Spring Cloud CLI`}</a>{`.`}</p>\n    <p>{`Then add the Spring cloud starter as dependency. When using config server, we need to add the config client. `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-conflig-client</artifactId>\n</dependency>\n`}</code></pre>\n    <p>{`For centralized tracing uses, starter-sleuth, and zipkin.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-sleuth</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-zipkin</artifactId>\n</dependency>\n`}</code></pre>\n    <p>{`For service discovery add netflix-eureka-client.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-eureka</artifactId>\n</dependency>\n`}</code></pre>\n    <p>{`Using the Spring Cloud CLI we can get the service registry, config server, central tracing started in one command:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`spring cloud eureka configserver zipkin\n`}</code></pre>\n    <h3>{`Spring Cloud config`}</h3>\n    <p>{`Use the concept of Config Server you have a central place to manage external properties for applications across all environments.  As an application moves through the deployment pipeline from dev to test and into production you can manage the configuration between those environments and be certain that applications have everything they need to run when they migrate. `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`  @Value(\"\\${config.in.topic}\")\n  String topicName = \"orders\";\n`}</code></pre>\n    <p>{`The value of the `}<inlineCode parentName=\"p\">{`config.in.topic`}</inlineCode>{` comes from local configuration or remote config server. The config server will serve content from a git. See `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/spring-cloud-samples/configserver\"\n      }}>{`this sample`}</a>{` for such server.`}</p>\n    <h2>{`Spring Cloud Stream`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://spring.io/projects/spring-cloud-stream\"\n      }}>{`Spring Cloud Stream`}</a>{` is a framework for building highly scalable event-driven microservices connected with shared messaging systems. It unifies lots of popular messaging platforms behind one easy to use API including RabbitMQ, Apache Kafka, Amazon Kinesis, Google PubSub, Solace PubSub+, Azure Event Hubs, and Apache RocketMQ. `}</p>\n    <p>{`Spring Cloud Stream is an abstraction that uses the following important concepts to supporet middleware encapsulation: `}<strong parentName=\"p\">{`destination binders`}</strong>{` (integration with messaging systems like Kafka or RabbitMQ), `}<strong parentName=\"p\">{`destination bindings`}</strong>{` (bridge code to external systems) and `}<strong parentName=\"p\">{`message`}</strong>{` (canonical data model to communicate between producer and consumer). `}</p>\n    <p>{`As other Spring boot application, it uses extrernal properties to manage most of the configuration of the binders and binding.`}</p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://spring.io/projects/spring-cloud-stream-applications\"\n      }}>{`Spring Cloud Stream Applications`}</a>{` are standalone executable applications that communicate over messaging middleware such as Apache Kafka and RabbitMQ. The app is using uber-jars to get the minimal required library and code The following diagram illustrates those concepts for a Spring cloud app:`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1040px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"76.38888888888889%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADE0lEQVQ4y22S628UZRSH+ev85AcwolgvJH7wEqPBGhP/ACJYNahpDdAg0IiaVijaIFAwULvtdu9tMb3sdXbntrttt7O32W27M4/nnd0WmjjJM+e8c8783t97OdHzPIr1Nma7i+12sFxX8g56s4vR6gb5IWqsN1pCA6PRlCjU+7nn+6jnxIFEa3sNMz9LdmNBWETLPGWrGqZizVPSlihqcbR8lLIVxq5XsZptoSm0ApRgz3tB0K7GsDZuspmYIp2YpLAyQc2copL5iY3IBJuRG6yHb1Jev0zFKWA2ZSUiYoqYqeIxh/KyyhHq2hgbsUlWw9NsZ6+yY9ymrl+n9O8EiadTaKu3aOiXsZwtEXKPBFU87lAJ2os0cl9iPbtEJvwDTvoCu9pV6rkRtta+Zj30I7bUGrmLIlj+f8EX99DYybMte2boIZ6tPMQoPiCXnqFYeIiWm2V9bR7bDLFVCWHVayLUPlqqNTicYw5tO4STF2faFZqlUTKxG6SeXGP1nwnZt3Fa+ihOYUx6xig7Zv9Q5KQPMQV1WwJBpVzarWI7OtaugVmT6NispDPMLelElm2WUjrRFUswKOzK1WntU2ruHaHGfTkRVEZdd1scTMq+3aGm/UG9+DvV9M/i7C5tc4a2MU3HVPk9ye/g6r/hqmjdlThFR/8V34n0BdWrk/mevYWX8OOvCKfwIi/Ti56C1Bnh9IDXYFlInRSktnx6UJdvyVflZH/BPxR0187TjQ7RjH+KE/mIVuIcvdS70vgWfvLtAJV3E+/TTAzjpoZpxT/BS76DnxKSb+CXp587PNg8T/rx5/z1aJEr49eZ/XuenegXMrs0Js/KT2dF8HWykWv8eT/EzL1HLITm2E/IpCmZMPUmlG8/30PyX7EXG6IW/QzjyXs4sWFpViJnRHAocKAEO8kPqSx8jDX3AY34uaBGUJflVw4d+h6+eUtER6D4DZSEwgVhhF72O7JyfQpz4xRD44Oei32Cnkv4+W9lPApde+BQ3fCei9/rCHt4QVS44KnYDujnnaDuHQz65Ruq7u3374xo/QfigSf/SZ/hSAAAAABJRU5ErkJggg==')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"spring stream app\",\n        \"title\": \"spring stream app\",\n        \"src\": \"/refarch-eda/static/fcd4bb2d5228b357d693887503dc1805/afe5f/spring-stream-app.png\",\n        \"srcSet\": [\"/refarch-eda/static/fcd4bb2d5228b357d693887503dc1805/7fc1e/spring-stream-app.png 288w\", \"/refarch-eda/static/fcd4bb2d5228b357d693887503dc1805/a5df1/spring-stream-app.png 576w\", \"/refarch-eda/static/fcd4bb2d5228b357d693887503dc1805/afe5f/spring-stream-app.png 1040w\"],\n        \"sizes\": \"(max-width: 1040px) 100vw, 1040px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p><strong parentName=\"p\">{`Attention`}</strong>{` Spring Cloud Stream is not Kafka Streams or Kafka API, it is similar but it represents another abstraction. From a Kafka developer’s point of view, it does not seem relevant, as why not using Kafka API and Kafka Streams API, but this is a way to encapsulate any middleware supporting pub/sub and queueing. It may be more comparable to Microprofile reactive messaging specifications and APIs, but not compatible with it. For example binding can be compared to channel of the microprofile reactive messaging constructs.`}</p>\n    <p>{`So the development decision will be around middleware abstraction and the way to simplify going from one middleware to another. Now with Kafka, because of its long retention time, it means we can have any type of consumers to read the messages at any time. Those consumers may use Kafka API (Python app or nodejs apps), in this case using the Kafka API within the Spring boot application is a better approach, as the way the abstraction is used may not be fully compatible to any Kafka consumer types.`}</p>\n    <p>{`With Kafka based application the best practice is also to define the message structure, using Avro or Protbuf, and use schema registry to ensure compatibility management between applications. To support that Spring Cloud Stream support using native (to the middleware) serialization, which in the case of Kafka could be any serdes APIs or avro API. We will cover that `}<a parentName=\"p\" {...{\n        \"href\": \"#avro-serialization\"\n      }}>{`in later section`}</a>{`.`}</p>\n    <h3>{`Example of Kafka binding`}</h3>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/eda-quickstarts/tree/main/spring-cloud-stream\"\n      }}>{`order service spring cloud template`}</a>{` is a simple example of order service that exposes CRUD operations on the Order entity via a controller. Instead of writing to a database, this service immediately generates a message to Kafka and then the repository class consumes the message to get the data to write to the database. This is a simple way to implement ‘transaction’ by using the Append log of Kafka partition as a transaction log.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1152px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"64.93055555555556%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACuklEQVQ4y2WRW28bZRCG8wtBKiDaQqESElSivQpcIIR6y2WvUC8QVFRAKyJRJSQNgZzknOrEu3bSHGyrPqz3aK8bew9OvN7dh9kNbWn5pEczmp3v3febmUrSlNEkISIhFsbCKM5qE84ncc44zuKEUTRmnNejnOzum2cqE7PtAieVx1RKa5zs/4ltrmN4Hp2hL3hoGd45ehjTCSM6wYSWN2Y4HuciaSb8L1NhFNOzl2nsz7CzMk+t9JDn5iym52P6QR4NP6TrlrE6q7Qa2zjGOrq5xfMw5DQI2GppFBptHOnNBS33GMss0mztYJq7OO6ROAxyzCz6Z/TtRdqV7ykXZmiqP2A1f6EvAp2ey1y9waPqMzqDoQjKjBx7i1plEWX7MYd7f9C1VsVdiCUOsqfrXohp7VLdX+Kg9BfH6hKmvoYfRflLLRmJIWRzzgUzgaH5ALfzK277PgPjIb32DK3D3zlRHmDUfsZp3MN59iPd5k94+j26+hyDs7P/LyWIJpi9Q1nME5xuEcvaxNA3UJUymxsKa6tF1NIumlak23uC7UifvYPulBmMk1wkSZN8MRlTsRT8QZWhscDAXEGrzqJXH2HUl4R5zPosfW2ZU/1vfHMBz1rGs1fwjHmi3rKojUgvVn3hkDiE2jegvg2ld2H3LYKNSySlK1K7DOUPYP9DiZKrkpevXaC8Dydfkk58+K9gGvVJj76gW/waZeE29cK39LdviuBVUvU6ifIRaYb6gmvCx6Tyw7T6lTiM3nAYnYrgNPXNO8z9dpf1xfsYhWlx8I44EZcVcaJeyQVQXnAV9t6DY+mLR687JHJJa7fh4FM4+hye3pD4GefKLZz1aezVaUZ7t+DwBumBfMt4elPG8Am0v3sl9vLJyTmMWkKbNKcpeZM40AhdjcDVmXhaXkvDxsteRpInZ6+5y84/wleoEE1KteEAAAAASUVORK5CYII=')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"spring orderms app\",\n        \"title\": \"spring orderms app\",\n        \"src\": \"/refarch-eda/static/89155c10f50039bf6e6a0308c9fb0613/3cbba/spring-orderms-app.png\",\n        \"srcSet\": [\"/refarch-eda/static/89155c10f50039bf6e6a0308c9fb0613/7fc1e/spring-orderms-app.png 288w\", \"/refarch-eda/static/89155c10f50039bf6e6a0308c9fb0613/a5df1/spring-orderms-app.png 576w\", \"/refarch-eda/static/89155c10f50039bf6e6a0308c9fb0613/3cbba/spring-orderms-app.png 1152w\", \"/refarch-eda/static/89155c10f50039bf6e6a0308c9fb0613/e0537/spring-orderms-app.png 1208w\"],\n        \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`The way to generate code from a POST or an internal processing is to use `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/spring-cloud/spring-cloud-stream/blob/master/spring-cloud-stream/src/main/java/org/springframework/cloud/stream/function/StreamBridge.java\"\n      }}>{`StreamBridge`}</a>{`, which exposes a send function to send the record.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`    @Autowired\n    private StreamBridge streamBridge;\n\n    public Order processANewOrder(Order order) {\n        order.status = OrderStatus.OPEN;\n        order.orderID = UUID.randomUUID().toString();\n        order.creationDate = LocalDate.now();\n        streamBridge.send(BINDING_NAME, order);\n        return order;\n    }\n`}</code></pre>\n    <p>{`As a good practice is to send a Kafka Record with a Key, which is specialy needed when sending messages to a multi partition topic: The messages with the same key will always go to the same partition. If the partition key is not present, messages will be partitioned in round-robin fashion. Spring Cloud Stream is little bit confusing as it created two concepts for partitioning: the partitionKey and the message key. The partition key is the way to support the same mechanism as Kafka is doing but for other middleware. So for Kafka we do not need to use partitionKey, but then it is important to use the message key construct. As Kafka is evolving on the partition allocation, it is recommended to do not interfere with Kafka mechanims and use the following approach:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Provide the message key as a SpEL expression property for example in the header: `}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-properties\"\n          }}>{`spring.cloud.stream.bindings.<binding-name>.producer.message-key-expression: headers['messageKey']\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Then in your application, when publishing the message, add a header called `}<inlineCode parentName=\"p\">{`kafka_messagekey`}</inlineCode>{` with the value set from the attribute to use as key. Spring Cloud Stream will use the value for this header to assign it to the Kafka record Key:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-java\"\n          }}>{` Message<Order> toSend = MessageBuilder.withPayload(order)\n        .setHeader(KafkaHeaders.MESSAGE_KEY, order.customerID.getBytes())\n        .setHeader(MessageHeaders.CONTENT_TYPE, MimeTypeUtils.APPLICATION_JSON).build();\n    streamBridge.send(BINDING_NAME, toSend);\n`}</code></pre>\n      </li>\n    </ul>\n    <p>{`You can also build composite key with a special java bean class for that and use instance of this class as key.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`\\`\\`\\`java\n CustomerCompanyKey cck = new CustomerCompanyKey(order.customerID,customer.company);\n Message<Order> toSend = MessageBuilder.withPayload(order)\n        .setHeader(KafkaHeaders.MESSAGE_KEY, cck)\n        .setHeader(MessageHeaders.CONTENT_TYPE, MimeTypeUtils.APPLICATION_JSON).build();\n    streamBridge.send(BINDING_NAME, toSend);\n\\`\\`\\`\n`}</code></pre>\n    <p>{`The following screen shot illustrates that all records with the same “customerID” are in the same partition:`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1152px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"30.208333333333332%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABU0lEQVQY03VQy07CUBTsh2jSd4XSN6UP+qIp0ETQYEKM/QUX6AZcupC4doUJhsQf4BfHc2+iOxeTc869ZyZnRgiCAHVdoygK1JMJ+lGMy2QMWVEgiSIkSYIsy7yK/82SyMF6wXFcTGctmukcs3mLYZJC7Pc5SVVVKEyYFlmvadqf2O+sUJVUjYPtCoZhYL1eY7d7Qdd1OJ/PeN5skCYJjscjDocDsizDdrvF6XTCarVCQn9v+z2+v45YPD7h4vUD2vsnjHpGF3o+bld3WC5v0LYt7h86VNWEk1gU14slCebI8xxN0yBNU8RxjLKqeEQW8XthBHMUQydnwoAeGrLKMmSkupliNIq4oO/7yPKCRMYIAh/D4RBhGCKKIrDsPc+DTrZ7OoMOjewLV5aNnC7KyVZZliRa8EUm5rouiYQ0+3Ach88M7N+2bd6bpomBZcEisPh+APsOylK6SeCgAAAAAElFTkSuQmCC')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"orders topic\",\n        \"title\": \"orders topic\",\n        \"src\": \"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/3cbba/orders-topic.png\",\n        \"srcSet\": [\"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/7fc1e/orders-topic.png 288w\", \"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/a5df1/orders-topic.png 576w\", \"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/3cbba/orders-topic.png 1152w\", \"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/0b124/orders-topic.png 1728w\", \"/refarch-eda/static/d4642f0fca62cb28996aef9666241991/62116/orders-topic.png 2302w\"],\n        \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`If you want to use the partition key as an alternate way to do partition allocation using Spring Cloud Stream strategy then use a partitionKey:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-properties\"\n      }}>{`spring.cloud.stream.bindings.<binding-name>.producer.partition-key-expression: headers['partitionKey']\n`}</code></pre>\n    <p>{`and then in the code:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`Message<Order> toSend = MessageBuilder.withPayload(order)\n            .setHeader(\"partitionKey\", order.customerID.getBytes())\n            .setHeader(MessageHeaders.CONTENT_TYPE, MimeTypeUtils.APPLICATION_JSON).build();\n        streamBridge.send(BINDING_NAME, toSend);\n`}</code></pre>\n    <h3>{`Consuming message`}</h3>\n    <p>{`With the last release of Spring Cloud Stream, consumers are single beans of type `}<inlineCode parentName=\"p\">{`Function`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`Consumer`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`Supplier`}</inlineCode>{`. Here is an example of consumer only.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`    @Bean\n    public Consumer<Message<Order>> consumeOrderEvent(){\n        return msg -> saveOrder(msg.getPayload());\n    }\n`}</code></pre>\n    <p>{`For thew binding configuration the name of the method gives the name of the binding:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`spring.cloud.stream:\n  bindings:\n    consumeOrderEvent-in-0:\n      destination: orders\n      contentType: application/json\n      group: orderms-grp\n      useNativeDecoding: true\n  kafka:\n    bindings:\n      consumeOrderEvent-in-0:\n        consumer:\n          ackMode: MANUAL\n          configuration:\n            value.deserializer: ibm.eda.demo.infrastructure.events.OrderDeserializer\n`}</code></pre>\n    <p>{`The deserialization is declared in a specific class:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`package ibm.eda.demo.infrastructure.events;\n\nimport org.springframework.kafka.support.serializer.JsonDeserializer;\n\npublic class OrderDeserializer extends JsonDeserializer<Order> {\n    \n}\n`}</code></pre>\n    <p>{`In this example above as the goal is to save to the database, we should not auto commit the offset reading. So the following settings are needed on the consumer side:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`spring.cloud.stream.kafka:\n    bindings:\n      consumeOrderEvent-in-0:\n        consumer:\n          autoCommitOffset: false\n          startOffset: latest\n          ackMode: MANUAL\n`}</code></pre>\n    <p>{`And the consumer code is now looking at the acknowledge header property if present or not and perform manual acknowledge once the save operation is successful.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{` @Bean\n    public Consumer<Message<Order>> consumeOrderEvent(){\n        return msg -> {\n            Acknowledgment acknowledgment = msg.getHeaders().get(KafkaHeaders.ACKNOWLEDGMENT, Acknowledgment.class);\n            saveOrder(msg.getPayload());\n            if (acknowledgment != null) {\n                acknowledgment.acknowledge();\n            }\n        };\n`}</code></pre>\n    <h3>{`Kafka spring cloud stream app basic`}</h3>\n    <p>{`The approach to develop such application includes the following steps:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`A spring boot application, with REST spring web starter`}</li>\n      <li parentName=\"ul\">{`Define a resource and a controller for the REST API.`}</li>\n      <li parentName=\"ul\">{`Define inbound and/or outbound binding to communicate to underlying middleware`}</li>\n      <li parentName=\"ul\">{`Add method to process incoming message, taking into account the underlying middleware and serialization. For example with Kafka, most of the consumers may not auto commit the read offset but control the commit by using manual commit. `}</li>\n      <li parentName=\"ul\">{`Add logic to produce message using middleware `}</li>\n    </ul>\n    <p>{`To add a consumer from a Kafka topic for example, we can add a function that will process the message, and declare it as a Bean. `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{` @Bean\n    public Consumer<Message<CloudEvent>> consumeCloudEventEvent(){\n        return msg -> {\n            Acknowledgment acknowledgment = msg.getHeaders().get(KafkaHeaders.ACKNOWLEDGMENT, Acknowledgment.class);\n            saveOrder((Order)msg.getPayload().getData());\n            if (acknowledgment != null) {\n                System.out.println(\"Acknowledgment provided\");\n                acknowledgment.acknowledge();\n            }\n        };\n    }\n`}</code></pre>\n    <p>{`This previous code is also illustrating manual offset commit.`}</p>\n    <p>{`Then we add configuration to link to the binders queue or topic:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`    consumeOrderEvent-in-0:\n        consumer:\n          autoCommitOffset: false\n          startOffset: latest\n          ackMode: MANUAL\n          configuration:\n            value.deserializer: ibm.eda.demo.infrastructure.events.CloudEventDeserializer\n`}</code></pre>\n    <h3>{`Avro serialization`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`producer:\n        useNativeEncoding: true\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}